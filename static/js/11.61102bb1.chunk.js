(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{2548:function(e,t,n){"use strict";n.d(t,"g",function(){return a}),n.d(t,"f",function(){return c}),n.d(t,"e",function(){return o}),n.d(t,"h",function(){return i}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r=n(2577),a=function(e,t,n){return{type:r.i,sequenceId:e,subSequenceId:t,patternNumber:n}},c=function(e){return{type:r.f,work:e,isTransport:!0}},o=function(e){return{type:r.e,work:e}},i=function(e){return{type:r.j,work:e}},s=function(e,t){return{type:r.c,sequenceId:e,transpose:t}},u=function(e,t){return{type:r.d,sequenceId:e,volume:t}},l=function(e,t){return{type:r.b,sequenceId:e,color:t}},d=function(e){return{type:r.a,bpm:e}}},2551:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(13),o=n(14),i=n.n(o);n(225);t.a=Object(c.b)(function(e,t){t.sequencerEngine,t.id,t.renderLength;return{currentTime:e.freeze.offlineEngine&&e.freeze.offlineEngine.context&&Math.floor(e.freeze.offlineEngine.context._context.currentTime),currentExportInfo:e.freeze.currentExportInfo}},null)(function(e){var t=e.currentTime,n=void 0===t?0:t,r=e.renderLength,c=e.width,o=void 0===c?380:c,s=e.currentExportInfo,u=n/(r*(new i.a.Time("1n").toMilliseconds()/1e3)),l={width:o*u},d=s;return a.a.createElement("div",{className:"progress-bar"},a.a.createElement("div",{className:"inner-progress-bar"},a.a.createElement("div",{className:"progress",style:l}),a.a.createElement("div",{className:"loading-text"},d?"Exporting "+d.name+" "+(d.index+1)+"/"+d.total+" ":"Exporting Project ","(",Math.round(100*u),"%)...")))})},2565:function(e,t,n){"use strict";var r=n(3),a=n(4),c=n(7),o=n(11),i=n(1),s=n(0),u=n.n(s),l=n(13),d=n(44),f=n(84);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var p=function(e){Object(c.a)(n,e);var t=m(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={clockDragging:!1,clockStartDragY:void 0,clockDragY:void 0},a}return Object(a.a)(n,[{key:"onClockMouseLeave",value:function(e){void 0!=this.seekTimer&&(clearInterval(this.seekTimer),this.seekTimer=void 0)}},{key:"onClockMouseDown",value:function(e){var t=this;void 0!==this.props.sequencerEngine&&(this.state.clockStartDragY=e.clientY,this.seekTimer=setInterval(function(){if(void 0!==t.state.clockDragY){var e=t.state.clockStartDragY-t.state.clockDragY,n=t.props.sequencerEngine.trackStep+5*e;n<0&&(n=0),t.props.sequencerEngine.seekToTrackStep(n)}},50))}},{key:"onClockMouseUp",value:function(e){clearInterval(this.seekTimer),this.seekTimer=void 0}},{key:"onClockMouseMove",value:function(e){this.state.clockDragY=e.clientY}},{key:"onClickMetronome",value:function(){void 0!==this.props.sequencerEngine&&(this.props.sequencerEngine.metronomeOn=!this.props.sequencerEngine.metronomeOn)}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.currentGlobalStep/32);t=isNaN(t)?1:t;var n=1+Math.floor(this.props.currentGlobalStep/8)%4,r=1+Math.floor(this.props.currentGlobalStep/2)%4,a="clock ";this.props.clockTick&&(a+="percentage-"+this.props.clockTick);var c="metronome";return this.props.metronomeOn&&(this.props.currentGlobalStep/4%4>=2&&(c+=" off-beat"),c+=" on"),u.a.createElement("div",{className:a,onMouseLeave:function(t){return e.onClockMouseLeave(t)},onMouseDown:function(t){return e.onClockMouseDown(t)},onMouseUp:function(t){return e.onClockMouseUp(t)},onMouseMove:function(t){return e.onClockMouseMove(t)}},u.a.createElement("div",{className:"track-time"},t),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},n),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},r),u.a.createElement(f.a,{element:d.P,onClick:function(){return e.onClickMetronome()},className:c},u.a.createElement("div",{className:"dot first"}),u.a.createElement("div",{className:"dot second"})))}}]),n}(s.Component);t.a=Object(l.b)(function(e,t){if(void 0===t.sequencerEngine)return{currentStep:0,currentGlobalStep:0,clockTick:0,metronomeOn:!1};var n=t.sequencerEngine.getSequenceId();return{currentStep:e.sequencer.currentStep[n]||0,currentGlobalStep:e.sequencer.currentGlobalStep[n]||0,clockTick:e.clock.clockTick,metronomeOn:t.sequencerEngine.metronomeOn}},null)(p)},2576:function(e,t,n){},2577:function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"j",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"h",function(){return d}),n.d(t,"g",function(){return f});var r=1,a=2,c=3,o=4,i=5,s=6,u=7,l=8,d=9,f=10},2591:function(e,t,n){"use strict";var r=n(2),a=n.n(r),c=n(12),o=n(3),i=n(4),s=n(18),u=n(7),l=n(11),d=n(1),f=n(85),m=n(5),p=n(0),v=n.n(p),h=n(109),b=n.n(h),g=n(960),k=n(215),E=n(76),O=n(13),j=(n(2576),Object(O.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.onClickCancel,r=Object(p.useState)(""),o=Object(m.a)(r,2),i=o[0],s=o[1],u=Object(p.useState)(8),l=Object(m.a)(u,2),d=l[0],h=l[1],O=Object(p.useState)(.1),j=Object(m.a)(O,2),w=j[0],S=j[1],y=Object(p.useState)(!1),x=Object(m.a)(y,2),C=x[0],q=x[1],N=Object(p.useState)(!1),T=Object(m.a)(N,2),L=(T[0],T[1]),M=Object(p.useCallback)(Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.next=3,Object(g.c)(t,i,d,w*Math.pow(10,18));case 3:L(!0),q(!1);case 5:case"end":return e.stop()}},e)})),[w,i,d,q,L]);return v.a.createElement(f.a,{dialogClassName:"mint-modal preset-modal render-modal",show:!0,onHide:n},v.a.createElement(f.a.Header,{closeButton:!0},v.a.createElement(f.a.Title,null,"Mint NFT")),v.a.createElement(f.a.Body,null,C?v.a.createElement(k.a,{text:"Minting your nft"}):v.a.createElement("div",null,v.a.createElement("input",{placeholder:"Title your work",value:i,type:"text",onChange:function(e){return s(e.target.value)}}),v.a.createElement("div",{className:"editions"},v.a.createElement("div",{className:"value"},"Editions: ",d),v.a.createElement(b.a,{value:d,change:function(e){return h(e.target.value)},step:1,max:1e3,min:1,orientation:"horizontal",reversed:!1})),v.a.createElement("div",{className:"price"},v.a.createElement("div",{className:"value"},"Price: ",w," eth"),v.a.createElement(b.a,{value:w,change:function(e){return S(e.target.value)},step:.001,max:1,min:.001,orientation:"horizontal",reversed:!1})))),v.a.createElement(f.a.Footer,null,v.a.createElement(E.b,{variant:"secondary",onClick:M},"Mint!"),v.a.createElement(E.b,{variant:"primary",onClick:n},"Cancel")))})),w=n(10),S=n(9),y=n(33);function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r,c,o,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.encryption.getPotentialUsers();case 2:t=e.sent,[],n=[],r=x(t),e.prev=6,r.s();case 8:if((c=r.n()).done){e.next=16;break}return o=c.value,e.next=12,y.a.users.getUserName(o);case 12:(i=e.sent)&&""!==i&&n.push({id:o,userName:i});case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return console.log("USERS =",n),e.abrupt("return",n);case 26:case"end":return e.stop()}},e,null,[[6,18,21,24]])}));return function(){return e.apply(this,arguments)}}(),N=Object(O.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onSharedWithChanged,n=(e.guildId,Object(p.useState)("")),r=Object(m.a)(n,2),a=r[0],c=r[1],o=Object(p.useState)([]),i=Object(m.a)(o,2),s=i[0],u=i[1],l=Object(p.useState)([]),d=Object(m.a)(l,2),f=d[0],h=d[1],b=Object(p.useState)([]),g=Object(m.a)(b,2),k=g[0],E=g[1];Object(p.useEffect)(function(){},[u]),Object(p.useEffect)(function(){t(s)},[s]),Object(p.useEffect)(function(){q().then(function(e){return h(e)})},[h]);var O=Object(p.useCallback)(function(e){u([].concat(Object(S.a)(s),[e])),c(""),E([])},[s,u,E]),j=Object(p.useCallback)(function(e){"Enter"===e.key&&O(a)},[u,a,s]);Object(p.useEffect)(function(){if(""===a.trim())E([]);else{var e=f.filter(function(e){return e.userName.toLowerCase().includes(a.toLowerCase())});E(e)}},[a,E]);var w=Object(p.useCallback)(function(e){u(s.filter(function(t){return t!==e}))},[u,s]);return v.a.createElement("div",{className:"share-with-people"},v.a.createElement("div",{className:"people-input-container"},s.map(function(e){return v.a.createElement("div",{className:"shared-user"},e,v.a.createElement("div",{onClick:function(){return w(e)},className:"delete-user"},"x"))}),v.a.createElement("input",{placeholder:"Type collaborators to share this with",className:"people-input",value:a,type:"text",onKeyDown:j,onChange:function(e){return c(e.target.value)}})),v.a.createElement("div",{className:"auto-completion-users"},k.map(function(e){return v.a.createElement("div",{onClick:function(){return O(e.userName)},className:"auto-completed-user"},e.userName)})))}),T=n(87);function L(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){return new Promise(function(){var t=Object(c.a)(a.a.mark(function t(n){var r,c,o,i,s,u,l,d,f,m,p;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=y.a.users,c=y.a.guilds,o=void 0,i=Object(S.a)(e),t.t0=e,t.next=6,r.getUserName();case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),s=L(e),t.prev=9,s.s();case 11:if((u=s.n()).done){t.next=23;break}return l=u.value,t.next=15,r.getUserId(l);case 15:return d=t.sent,t.next=18,c.getGuildsForUser(d);case 18:f=t.sent,f=new Set(f.map(function(e){return e.guildId})),o=void 0===o?f:A(o,f);case 21:t.next=11;break;case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(9),s.e(t.t2);case 28:return t.prev=28,s.f(),t.finish(28);case 31:if(o=Array.from(o),m=void 0,0!==o.length){t.next=40;break}return t.delegateYield(a.a.mark(function t(){var o,s,u,l,d,f,p;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.join(","),t.next=3,c.newGuild(o);case 3:s=t.sent;case 4:return t.next=7,c.getGuildsForUser();case 7:if(u=t.sent,console.log("GUILDS found =",u),!(m=u.find(function(e){return e.name===o}))){t.next=13;break}return m=m.guildId,t.abrupt("break",17);case 13:return t.next=15,Object(T.a)(2e3);case 15:t.next=4;break;case 17:c.saveGuildKey(m,s),n(m),l=L(i),t.prev=20,l.s();case 22:if((d=l.n()).done){t.next=31;break}return f=d.value,t.next=26,r.getUserId(f);case 26:return p=t.sent,t.next=29,c.requestToAddMember(m,p);case 29:t.next=22;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(20),l.e(t.t0);case 36:return t.prev=36,l.f(),t.finish(36);case 39:return t.abrupt("return",{v:void 0});case 40:case"end":return t.stop()}},t,null,[[20,33,36,39]])})(),"t3",35);case 35:if("object"!==typeof(p=t.t3)){t.next=38;break}return t.abrupt("return",p.v);case 38:t.next=41;break;case 40:m=o[0];case 41:n(m);case 42:case"end":return t.stop()}},t,null,[[9,25,28,31]])}));return function(e){return t.apply(this,arguments)}}())},A=function(e,t){var n,r=[],a=L(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;t.has(c)&&r.push(c)}}catch(u){a.e(u)}finally{a.f()}var o,i=L(t);try{for(i.s();!(o=i.n()).done;){var s=o.value;e.has(s)&&r.push(s)}}catch(u){i.e(u)}finally{i.f()}return new Set(r)},D=n(2551),R=n(292);function P(e){var t=e.sequencerEngine,n=(e.selectedGuild,t.getAllRecordingsToSave().length);return 0===n?v.a.createElement("div",null):v.a.createElement("div",{className:"save-recordings"},"You have ",n," new sounds to",v.a.createElement("span",{onClick:function(){return t.saveAnyNewRecordings(0)},className:"save-recordings-button"},"save"),".")}n(1493),n(55);var W=n(45),H=n(263);function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var U=function(e){Object(u.a)(n,e);var t=G(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={sequenceHash:void 0,creatingLink:!1},r}return Object(i.a)(n,[{key:"getLink",value:function(){return window.explore?"https://zequencer.io/explore/"+this.state.sequenceHash:"https://zequencer.io/v3/"+this.state.sequenceHash}},{key:"copyLink",value:function(){var e=this,t=this.linkInput;t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),this.setState({copied:!0}),setTimeout(function(){return e.setState({copied:!1})},1e3)}},{key:"createLink",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({creatingLink:!0}),e.next=3,this.props.sequencerEngine.save(void 0,H.c,!1);case 3:t=e.sent,this.setState({sequenceHash:t,creatingLink:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"exportToWAV",value:function(){Object(R.a)(this.props.sequencerEngine)}},{key:"render",value:function(){var e=this;return v.a.createElement("div",{className:"link-creator"},v.a.createElement(W.a,{condition:void 0===this.state.sequenceHash},v.a.createElement("div",{onClick:function(){return e.createLink()},className:"link-button"},"Create Public Link")),v.a.createElement(W.a,{condition:void 0!==this.state.sequenceHash},v.a.createElement("div",null,"Link: ",v.a.createElement("input",{type:"text",value:this.getLink(),id:"linkInput",ref:function(t){e.linkInput=t}})),v.a.createElement("div",{onClick:function(){return e.copyLink()},className:"small-button pink-button"},"Copy Link"),v.a.createElement("div",{className:"clear-fix"}),v.a.createElement(W.a,{condition:this.state.copied},v.a.createElement("div",{className:"copied-info"},"Copied to clipboard!"))),v.a.createElement("div",{onClick:function(){return e.props.onClickExport()},className:"link-button export-to-wav-btn"},"Export to WAV"))}}]),n}(p.Component),B=n(1492),F=(n(225),n(1494),n(291),n(63)),V=(n(1495),n(281),n(44)),z=(n(708),n(964));function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Q=function(e){Object(u.a)(n,e);var t=J(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={nameValue:"",numTokens:1,saveOption:H.b,metamaskInstalled:!0,showBuying:!1,sequenceHash:void 0,copied:!1,selectedGuild:void 0,guildOptions:[],renderLength:64,mintNFT:!1,renderOption:z.b,shareWith:[],formingGuild:!1},r.input=void 0,r.onClickDone=r.onClickDone.bind(Object(s.a)(r)),r.onClickCancel=r.onClickCancel.bind(Object(s.a)(r)),r.onClickExport=r.onClickExport.bind(Object(s.a)(r)),y.a.tokenizedSequences.callback=function(){return r.onBalanceUpdated()},r}return Object(i.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&this.getGuilds(),e.show||e.show===this.props.show||(this.state.sequenceHash=void 0,this.state.copied=!1),!0}},{key:"getGuilds",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:H.a}),this.setState({selectedGuild:this.props.selectedGuild||t[0],guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.show!=e.show){this.input&&this.input.focus();var n=this.props.sequencerEngine.sequenceId;0===n&&-1===n&&void 0===n||y.a.guildSequences.getGuildSequence(n).then(function(e){e?(console.log("GUILD SEQUENCE =",e),t.setState({sequenceGuildId:e.guildId})):t.setState({sequenceGuildId:void 0})})}return!0}},{key:"onClickDone",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({showExportMode:!1}),!this.state.showBuying){e.next=6;break}y.a.tokenizedSequences.buyTokens(parseInt(this.state.numTokens)),this.setState({onPurchased:!0,showBuying:!1}),e.next=18;break;case 6:if(t=this.state.shareWith,n=void 0,!(this.state.saveOption===H.b&&t.length>0)){e.next=17;break}return this.setState({formingGuild:!0}),e.next=12,I(t);case 12:n=e.sent,this.setState({formingGuild:!1}),this.props.onSave(this.state.nameValue,H.a,{guildId:n}),e.next=18;break;case 17:this.props.onSave(this.state.nameValue,this.state.saveOption,this.state.selectedGuild);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){if(this.state.showBuying)this.setState({showBuying:!1});else{this.setState({showExportMode:!1,mintNFT:!1}),this.props.onHide();var e=this.props.sequencerEngine.state.freeze.offlineEngine;console.log("OFFLINE ENGINE =",e),e&&(console.log("SUSPENDING"),e.stop(),e.context._context.suspend(e.context._context.currentTime+.5).then(function(){console.log("DISPOSING"),e.dispose()}))}}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({saveOption:e.target.name})}},{key:"onTokenType",value:function(e){""===e&&this.setState({numTokens:0}),Object(F.a)(e)&&this.setState({numTokens:e})}},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"showExportMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showExportMode:e})}},{key:"onClickExport",value:function(){var e=this;this.setState({bouncing:!0}),setTimeout(Object(c.a)(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(R.a)(e.props.sequencerEngine,e.state.renderLength,e.state.renderOption);case 2:e.setState({bouncing:!1}),e.onClickCancel(),e.onClickCancel();case 5:case"end":return t.stop()}},t)})),80)}},{key:"onChangeRenderLength",value:function(e){try{var t=parseInt(e);this.setState({renderLength:t})}catch(n){}}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;return this.state.mintNFT?v.a.createElement(j,{onClickCancel:function(){return e.onClickCancel()},sequencerEngine:this.props.sequencerEngine}):this.state.showExportMode?v.a.createElement(f.a,{dialogClassName:"preset-modal render-modal",show:this.props.show,onHide:this.onClickCancel},v.a.createElement(f.a.Header,{closeButton:!0},v.a.createElement(f.a.Title,null,"Export Project")),v.a.createElement(f.a.Body,null,v.a.createElement("div",{className:"render-options"},v.a.createElement("div",{className:"render-label"},"Rendered Track"),v.a.createElement("div",{onClick:function(){return e.setState({renderOption:z.b})},className:this.state.renderOption===z.b?"selected render-option":"render-option"},"Master"),v.a.createElement("div",{onClick:function(){return e.setState({renderOption:z.a})},className:this.state.renderOption===z.a?"selected render-option":"render-option"},"Groups")),v.a.createElement("div",{className:"render-length"},v.a.createElement("div",{className:"render-label"},"Render Length"),v.a.createElement("input",{onChange:function(t){return e.onChangeRenderLength(t.target.value)},className:"render-length-input",value:this.state.renderLength})),this.state.bouncing?v.a.createElement(D.a,{renderLength:this.state.renderLength}):""),v.a.createElement(f.a.Footer,null,this.state.bouncing?"":v.a.createElement(E.b,{variant:"secondary",onClick:this.onClickExport},"Export"),this.state.bouncing?"":v.a.createElement(E.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):this.props.userToken?v.a.createElement(f.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},v.a.createElement(f.a.Header,{closeButton:!0},v.a.createElement(f.a.Title,null,"Save Project")),v.a.createElement(f.a.Body,null,v.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of project",className:"tag-input"}),v.a.createElement("form",null,v.a.createElement("input",{name:H.c,type:"checkbox",checked:this.state.saveOption===H.c,onChange:function(t){return e.handleCheckboxChange(t)}}),v.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(V.lb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Public"),v.a.createElement("input",{name:H.b,value:H.b,type:"checkbox",checked:this.state.saveOption===H.b,onChange:function(t){return e.handleCheckboxChange(t)}}),v.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(V.jb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Private"),v.a.createElement("input",{name:H.a,value:H.a,type:"checkbox",checked:this.state.saveOption===H.a,onChange:function(t){return e.handleCheckboxChange(t)}}),v.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(V.jb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Guild")),v.a.createElement(P,{selectedGuild:this.state.selectedGuild,sequencerEngine:this.props.sequencerEngine}),v.a.createElement(W.a,{condition:this.state.saveOption===H.b},v.a.createElement(N,{guildId:this.state.sequenceGuildId,onSharedWithChanged:function(t){return e.setState({shareWith:t})}}),this.state.formingGuild?v.a.createElement(k.a,{text:"Creating encrypted group"}):""),v.a.createElement(W.a,{condition:this.state.saveOption===H.a},v.a.createElement(B.a,{onSelectGuild:function(t){return e.onSelectGuild(t)},selectedGuild:this.state.selectedGuild,guildOptions:this.state.guildOptions})),v.a.createElement(U,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),this.state.formingGuild?"":v.a.createElement(f.a.Footer,null,v.a.createElement(E.b,{variant:"secondary",onClick:this.onClickDone},"Save"),v.a.createElement(E.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):v.a.createElement(f.a,{dialogClassName:"preset-modal save-modal",show:this.props.show,onHide:this.onClickCancel},v.a.createElement(f.a.Header,{closeButton:!0},v.a.createElement(f.a.Title,null,"Save Sequence")),v.a.createElement(f.a.Body,null,v.a.createElement("div",{className:"no-metamask"},v.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save your song to your account."),v.a.createElement(U,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),v.a.createElement(f.a.Footer,null,v.a.createElement(E.b,{variant:"secondary",onClick:this.onClickCancel},"Done")))}}]),n}(p.Component);t.a=Object(O.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setShowLogin:function(t){return e(Object(w.Vf)(t))},setContextualHelp:function(t){return e(Object(w.wb)(t))}}})(Q)},2602:function(e,t,n){"use strict";var r=n(2),a=n.n(r),c=n(9),o=n(12),i=n(8),s=n(3),u=n(4),l=n(7),d=n(11),f=n(1),m=n(2577),p=n(14),v=n.n(p),h=n(10);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}t.a=function(e){return function(e){Object(l.a)(n,e);var t=b(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).events=[],e.hasEdits=!1,e}return Object(u.a)(n,[{key:"isRecordingMix",get:function(){return this.state.explore.isRecordingMix}},{key:"currentTransportTime",get:function(){var e=parseFloat(v.a.Transport.position.split(":")[2]);return"0:0:"+(e-Math.floor(e)+this.trackStep/2)}},{key:"dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentTransportTime,r=e.sequenceId&&this.getSequencerEngine(e.sequenceId);switch(e.type){case m.i:this.switchToPattern(r,e.subSequenceId,e.patternNumber);break;case m.f:this.playWork(e.work);break;case m.e:this.loadWork(e.work);break;case m.j:this.unloadWork(e.work);break;case m.c:this.changeTranspose(r,e.transpose);break;case m.d:this.changeVolume(r,e.volume);break;case m.b:this.changeColor(r,e.color);break;case m.a:this.changeBPM(e.bpm)}!t&&this.isRecordingMix&&(e=Object(i.a)({},e,{time:n}),this.events.push(e),this.hasEdits=!0)}},{key:"playWork",value:function(e){this.play(e),this.isNothingPlaying()&&this.clearScheduledEvents()}},{key:"worksLoaded",get:function(){return this.state.explore.worksLoaded}},{key:"loadWork",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("MultiMix.loadWork =",t),!this.worksLoaded.some(function(e){return e.newSequence===t.newSequence})){e.next=5;break}return n=this.getSequencerEngine(t.newSequence),this.setWorkDefaults(n),e.abrupt("return");case 5:return this.store.dispatch(Object(h.Th)([].concat(Object(c.a)(this.worksLoaded),[t]))),e.next=8,this.loadTrack(t.newSequence);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadWork",value:function(e){if(this.worksLoaded.some(function(t){return t.newSequence===e.newSequence})){var t=Object(c.a)(this.worksLoaded),n=t.indexOf(e);t.splice(n,1),this.store.dispatch(Object(h.Th)(t)),this.unloadTrack(e.newSequence)}}},{key:"switchToPattern",value:function(e,t,n){e&&(e.switchToSubSequence(t),e.switchToPattern(n))}},{key:"changeColor",value:function(e,t){e&&(e.channelMixer.mixEffects.filter=t,this.store.dispatch(Object(h.pd)(e.sequenceId,t)))}},{key:"changeTranspose",value:function(e,t){e&&(e.transpose=t,this.store.dispatch(Object(h.Rh)(e.sequenceId,t)))}},{key:"changeVolume",value:function(e,t){e&&(e.setMasterVolume(t,.05),this.store.dispatch(Object(h.Sh)(e.sequenceId,t)))}},{key:"changeBPM",value:function(e){this.updateBpm(e)}},{key:"setInitialValuesForMix",value:function(){if(this.initialState){var e=this.initialState,t=e.workVolumes,n=e.worksLoaded,r=e.workTransposes,a=e.mixColorValues,c=e.bpm;for(var o in c&&this.changeBPM(c),t){var i=this.getSequencerEngine(o);i&&this.changeVolume(i,t[o])}for(var s in r){var u=this.getSequencerEngine(s);u&&this.changeTranspose(u,r[s])}for(var l in n)this.loadWork(n[l]);for(var d in a){var f=this.getSequencerEngine(d);f&&this.changeColor(f,a[d])}}}},{key:"saveInitialValuesForMix",value:function(){var e=this.store.getState();this.initialState={worksLoaded:Object(c.a)(e.explore.worksLoaded),workTransposes:Object(i.a)({},e.explore.workTransposes),workVolumes:Object(i.a)({},e.explore.workVolumes),bpm:e.user.bpm,mixColorValues:Object(i.a)({},e.explore.mixColorValues)}}},{key:"playMix",value:function(e){var t=this;e?(this.isRecordingMix?this.saveInitialValuesForMix():this.setInitialValuesForMix(),this.eventIds=this.events.map(function(e){return v.a.Transport.schedule(function(n){e.type===m.f&&(n=0),setTimeout(function(){t.dispatch(e,!0)},n)},e.time)}),this.play()):(this.clearScheduledEvents(),this.stop())}},{key:"clearScheduledEvents",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return v.a.Transport.clear(e)}),this.eventIds=[])}},{key:"setWorkDefaults",value:function(e){this.changeTranspose(e,0),this.changeVolume(e,0)}},{key:"hasEdits",set:function(e){this.store.dispatch(Object(h.rd)(e))}},{key:"unloadAll",value:function(){this.clearMix(),this.stop(),this.hasEdits=!1;var e=Object(c.a)(this.worksLoaded);for(var t in e)this.unloadWork(e[t])}}]),n}(e)}},2632:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(13);t.a=Object(c.b)(function(e,t){return{step:t.sequencerEngine.trackStep,isSequenceRolling:t.sequencerEngine.isSequenceRolling}},function(e){return{}})(function(e){var t=e.step,n=void 0===t?0:t,r=e.isSequenceRolling,c=e.sequencerEngine,o=void 0,i=void 0,s="";if(r){var u=c.tracks[0];if(u){var l=u.getFactoredResolution().getNumberOfStepsAtBaseResolution();u.patternRollStepNumber,u.pattern.stepBuckets.length,o=l,i=u.patternRollStepNumber}o=o;var d=i,f={left:4*Math.floor(d/4)%32*96/32+"vw",width:4*Math.floor(o/4)%32*96/32+"vw"};s=a.a.createElement("div",{className:"playhead roll-visualizer",style:f})}var m={left:4*Math.floor(n/4)%32*100/32+"vw"};return[s,a.a.createElement("div",{style:m,className:"playhead"})]})},2633:function(e,t,n){},2634:function(e,t,n){"use strict";var r=n(0),a=n.n(r);n(13);t.a=function(e){var t=e.setToggled,n=e.toggled,r=e.url,c=void 0===r?"/zequencer-logo-hiero.svg":r;return a.a.createElement("img",{onClick:function(){return t(!n)},className:n?"logo-hiero toggled":"logo-hiero",src:c})}},2656:function(e,t,n){"use strict";var r=n(3),a=n(4),c=n(7),o=n(11),i=n(1),s=n(0),u=n.n(s),l=n(13),d=n(2548);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=["A","B","C","D","E","F","G","H"],p=function(e){Object(c.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"switchPattern",value:function(e){var t=this.props.sequencerEngine;t.multiSequencerEngine.dispatch(Object(d.g)(t.sequenceId,t.currentSubSequence.id,e))}},{key:"chooseSubSequence",value:function(e){this.props.sequencerEngine.switchToSubSequence(e)}},{key:"getSubSequencesComponent",value:function(){var e=this,t=this.props.subSequences||[];return u.a.createElement("div",{className:"sub-sequence-buttons"},t.map(function(t,n){return u.a.createElement("div",{key:m[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},m[n])}))}},{key:"render",value:function(){var e=this;return void 0===this.props.sequencerEngine.tracks[0]?this.getSubSequencesComponent():u.a.createElement("div",null,u.a.createElement("div",{className:"pattern-buttons"},this.props.sequencerEngine.tracks[0].patterns.map(function(t,n){return u.a.createElement("div",{style:e.props.color&&e.props.currentPattern===n?{backgroundColor:e.props.color}:{},onClick:function(){return e.switchPattern(n)},className:e.props.currentPattern===n?"current pattern-button":"pattern-button"},n+1)})),this.getSubSequencesComponent())}}]),n}(s.Component);t.a=Object(l.b)(function(e,t){var n=t.sequencerEngine.engineId,r=t.sequencerEngine.currentSubSequence.id;return{currentPattern:e.sequencer.currentPattern[r]||0,subSequenceId:r,subSequences:e.sequencer.subSequences[n],currentSubSequence:e.sequencer.currentSubSequence[n]}},null)(p)},2657:function(e,t,n){"use strict";var r=n(2),a=n.n(r),c=n(12),o=n(3),i=n(4),s=n(10),u=(n(1505),n(2602),n(14)),l=n.n(u),d=n(541),f=n(1144),m=n(712),p=function(){function e(t){Object(o.a)(this,e),this.store=t,this.idToSequencerEngine={},this.headSequencerEngine=void 0,this.sequencerEnginesToPlay=[],this.sequenceIdQueue=[],window.sequencerEngine=this,this.initAubio()}return Object(i.a)(e,[{key:"getHead",value:function(){return this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]}},{key:"state",get:function(){return this.store.getState()}},{key:"trackStep",get:function(){for(var e in this.idToSequencerEngine){var t=this.idToSequencerEngine[e].trackStepReal;if(t>0)return t}return 0}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t})}},{key:"sampleRate",set:function(e){d.a.setSampleRate(e)}},{key:"stop",value:function(){for(var e in this.idToSequencerEngine)this.idToSequencerEngine[e].stop();l.a.Transport.stop()}},{key:"updateBpm",value:function(e){for(var t in this.idToSequencerEngine)this.idToSequencerEngine[t].updateBpm(e)}},{key:"getSequencerEngine",value:function(e){return void 0===e?this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]:this.idToSequencerEngine[e]}},{key:"stepOneCallback",value:function(e){this.sequencerEnginesToPlay.forEach(function(t){var n=l.a.Transport.getTicksAtTime(e),r=new l.a.TransportTime(n,"i");t.play(r)}),this.sequencerEnginesToPlay=[]}},{key:"getSamplerPlaySequence",value:function(){return null}},{key:"isNothingPlaying",value:function(){return 0===this.getSequencesPlaying().length}},{key:"getSequencesPlaying",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.getState().sequencer.isPlaying;return Object.keys(this.idToSequencerEngine).filter(function(n){return!1===e&&void 0===t[n]||t[n]===e})}},{key:"unloadTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.idToSequencerEngine[e];n.playing&&n.stop(),delete this.idToSequencerEngine[e];var r=this.sequenceIdQueue.indexOf(e);r>-1&&this.sequenceIdQueue.splice(r,1),this.store.dispatch(Object(s.Jc)(e,void 0)),t&&setTimeout(function(){n.dispose()},500)}},{key:"loadTrack",value:function(){var e=Object(c.a)(a.a.mark(function e(t){var n,r,c,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getSequencesPlaying(!1),this.sequenceIdQueue.length>7&&(n.length>0?this.unloadTrack(n[0]):(r=this.sequenceIdQueue.shift(),this.unloadTrack(r))),this.store.dispatch(Object(s.dd)(t,!0)),(c=new f.default(this.store,!0,void 0,this.aubio)).channelMixer.connectMixEffects(),o=new m.a(c,!0),c.setScripting(o),c.multiSequencerEngine=this,c.loadedSequenceId=t,c.setMasterVolume(1),this.sequenceIdQueue.push(t),this.idToSequencerEngine[t]=c,this.store.dispatch(Object(s.Jc)(t,!1)),e.next=15,c.loadSequence(t);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"initSamplerTrack",value:function(){}},{key:"sequenceRolling",value:function(){for(var e in this.idToSequencerEngine){if(this.idToSequencerEngine[e].isSequenceRolling)return!0}return!1}},{key:"play",value:function(e){var t=this,n=this.getSequencerEngine(e&&e.id);if(void 0!==n){n.playing&&this.getSequencesPlaying(!0).length,e&&e.playing&&this.setHeadSequencerEngine(void 0);var r=this.getSequencesPlaying(!0);0==this.getSequencesPlaying(!0).length||n.playing?(this.store.dispatch(Object(s.Kc)(!0)),n.playing||0!=r.length||this.setHeadSequencerEngine(n),n.play()):this.sequencerEnginesToPlay.push(n),(r=r.map(function(e){return t.idToSequencerEngine[e]}).filter(function(e){return e!==n})).length>0&&r.every(function(e){return void 0===e.stepOneCallback})&&this.setHeadSequencerEngine(r[0])}}},{key:"setHeadSequencerEngine",value:function(e){var t=this;void 0!==e||void 0===this.headSequencerEngine?(this.headSequencerEngine=e,this.headSequencerEngine.stepOneCallback=function(e){return t.stepOneCallback(e)}):this.headSequencerEngine.stepOneCallback=void 0}}]),e}();t.a=p},2707:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(9),o=n(31),i=n(13),s=n(35);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new o.a;var d=function(e,t){return(e%t+t)%t},f=Object(i.b)(function(e,t){return{step:t.sequencerEngine&&t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.row,o=e.part,i=e.step,l=void 0===i?0:i,f=Object(r.useCallback)(function(){var e=new s.a(Math.pow(2,2+Math.floor(o/2)),o%2===1);t.resolution=e,t.sequenceRolling=!0,t.trackRolling=!0},[t,o]),m=Object(r.useCallback)(function(){t.sequenceRolling=!1,t.trackRolling=!1},[t,o]),p=Object(r.useRef)(!1),v=Object(r.useRef)(void 0),h=new Set,b={},g=o===4*Math.floor(l/4)%32/32*8;if(t){var k,E=u(t.subSequences);try{for(E.s();!(k=E.n()).done;){var O,j=u(k.value.tracks);try{for(j.s();!(O=j.n()).done;){var w=O.value,S=w.notesTriggered||{};for(var y in S)y=d(y,12),h.add(y),b[y]||(b[y]=[]),b[y].push(w)}}catch(I){j.e(I)}finally{j.f()}}}catch(I){E.e(I)}finally{E.f()}}var x=2*n,C=2*n+1,q="triangle";if(h.has(x)||h.has(C)){var N=b[x]||[],T=b[C]||[],L=[].concat(Object(c.a)(N),Object(c.a)(T)).map(function(e){return"white"});g&&(p.current=!0,v.current=L[o%L.length],q+=" triggered")}else g&&l%4===0&&(p.current=!1);var M={};return p.current&&(q+=" old-trigger",void 0!==v.current?M.borderBottomColor=v.current:q+=" track-0"),a.a.createElement("div",{onMouseDown:f,onMouseUp:m,style:M,className:q})});t.a=function(e){var t=e.sequencerEngine,n=e.row;return a.a.createElement("div",{className:"row"},[0,1,2,3,4,5,6,7].map(function(e){return a.a.createElement(f,{sequencerEngine:t,row:n,part:e})}))}},2855:function(e,t,n){},2856:function(e,t,n){},2997:function(e,t,n){"use strict";n.r(t);var r=n(23),a=n(2),c=n.n(a),o=n(12),i=n(5),s=n(0),u=n.n(s),l=n(103),d=n(10),f=n(13),m=n(43),p=n(2707),v=(n(1127),n(2632)),h=(n(1120),n(2633),Object(f.b)(function(e,t){return{wallpaper:e.sequencer.wallpaper}},function(e){return{setIsPlayingMix:function(t){return e(Object(d.Kc)(t))}}})(function(e){var t=e.sequencerEngine;e.wallpaper;return u.a.createElement("div",{className:"exhibit"},t?u.a.createElement(v.a,{sequencerEngine:t}):"",u.a.createElement(p.a,{sequencerEngine:t,row:0}),u.a.createElement(p.a,{sequencerEngine:t,row:1}),u.a.createElement(p.a,{sequencerEngine:t,row:2}),u.a.createElement(p.a,{sequencerEngine:t,row:3}),u.a.createElement(p.a,{sequencerEngine:t,row:4}),u.a.createElement(p.a,{sequencerEngine:t,row:5}))}),n(96)),b=(n(1419),n(31)),g=n(713),k=n(2634),E=n(2783),O=n(2591),j=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useCallback)(function(e,n,r){t.save(e,n,!0,r),c(!1)},[c,t]);return u.a.createElement("div",null,u.a.createElement(O.a,{sequencerEngine:t,onSave:o,onHide:function(){return c(!1)},show:a}),u.a.createElement("div",{onClick:function(){return c(!0)},className:"work-save-button"}))}),w=n(9),S=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{setWorksLoaded:function(t){return e(Object(d.Th)(t))}}})(function(e){var t=e.setWorksLoaded,n=e.multiSequencerEngine,r=e.sequencerEngine,a=e.worksLoaded,c=Object(s.useCallback)(function(){var e=Object.values(n.idToSequencerEngine).filter(function(e){return e!==r});e.forEach(function(e){return r.subSequences=[].concat(Object(w.a)(r.subSequences),Object(w.a)(e.subSequences))}),e.forEach(function(e){return n.unloadTrack(e.getSequenceId(),!1)});var c=a.filter(function(e){return e.newSequence===r.getSequenceId()});t(c)},[a,r]);return a&&a.length>1?u.a.createElement("div",{onClick:c,className:"combine-works-button"},"Combine Projects"):""}),y=new b.a,x=Object(f.b)(function(e,t){var n=t.sequencerEngine.idToSequencerEngine[t.work.newSequence];return n?{worksLoaded:e.explore.worksLoaded,numSubSequences:n&&n.subSequences.length,pulledEffects:e.effects.pulledEffects}:{}},function(e){return{}})(function(e){var t=e.work,n=e.sequencerEngine,r=Object(s.useState)(!1),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(void 0),d=Object(i.a)(l,2),f=d[0],m=d[1],p=n.idToSequencerEngine[t.newSequence];return p?(Object(s.useEffect)(function(){c||m(void 0)},[c,m]),u.a.createElement("div",{className:"explore-work"},c&&f?u.a.createElement(g.a,{color:y.getColorForTrack(f),track:f}):p.subSequences.map(function(e){return u.a.createElement(E.a,{isExplore:!0,setSelectedTrack:m,toggled:c,subSequence:e,sequencerEngine:p})}),u.a.createElement(k.a,{setToggled:o,toggled:c}),u.a.createElement(S,{multiSequencerEngine:n,sequencerEngine:p}),u.a.createElement(j,{sequencerEngine:p}))):""}),C=n(55),q=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.pendingComments,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1];Object(s.useEffect)(function(){C.a.getUserName().then(c)},[c]);var o=Object(w.a)(t);return o.reverse(),o.map(function(e){return u.a.createElement("div",null,u.a.createElement("div",{className:"annotation"},u.a.createElement("div",{className:"author"},a,":"),u.a.createElement("div",{className:"content"},e)))})}),N=n(2545),T=n(33),L=n(30),M=n(65),I=new b.a,A={},D=function(e){var t=e.annotation,n=e.style,r=Object(s.useState)(""),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],v=Object(s.useState)([]),h=Object(i.a)(v,2),b=h[0],g=h[1];return Object(s.useEffect)(function(){var e=L.a.utils.fromAscii(t.annotationData),n=Object(M.a)(e);A[n]?o(A[n]):m.a.getJson(n).then(function(e){A[n]=e,o(e)}),T.a.users.getUserName(t.address).then(function(e){return p(e)})},[t,o,p]),Object(s.useEffect)(function(){T.a.xanadu.getContentReferences(t.annotationData).then(g)},[t,g]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},f,":"),u.a.createElement("div",{className:"content"},c),u.a.createElement("div",{className:"references"},b.map(function(e){return u.a.createElement("div",{style:{backgroundColor:I.getColorForHash(e)},className:"dot content-reference"})})))},R=function(e){var t=e.works,n=e.linkType,r=void 0===n?N.b:n,a=Object(s.useState)([]),c=Object(i.a)(a,2),o=c[0],u=c[1];return Object(s.useEffect)(function(){var e;(e=T.a.xanadu).getFlattenedAnnotations.apply(e,[r].concat(Object(w.a)(t.map(function(e){return e.newSequence})))).then(function(e){u(Object(w.a)(e))})},[t,u]),{comments:o}},P=n(225),W=n.n(P),H=(new b.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.works,n=e.linkType,r=void 0===n?N.b:n,a=R({works:t,linkType:r}).comments,c={};return a.reverse(),u.a.createElement("div",null,a.map(function(e){return u.a.createElement(D,{style:c,key:e.annotationData,annotation:e})}))})),G=n(76),U=(new b.a,Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.worksLoaded,n=e.linkType,r=void 0===n?N.b:n,a=Object(s.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(s.useState)([]),f=Object(i.a)(d,2),m=f[0],p=f[1];Object(s.useEffect)(function(){p([])},[t]);var v=Object(s.useCallback)(function(){t.map(function(e){var t=e.newSequence;return T.a.xanadu.newAnnotationContent(r,t,o)}),l(""),p([].concat(Object(w.a)(m),[o]))},[t,o,l,m,p]);return 0===t.length?[]:u.a.createElement("div",{className:"comments-pane"},u.a.createElement("div",{className:"work-comments"},u.a.createElement(H,{works:t}),u.a.createElement(q,{pendingComments:m})),u.a.createElement(G.g,{type:"textarea",value:o,className:"comment-text",placeholder:"Write a comment here",onChange:function(e){return l(e.target.value)}}),u.a.createElement("div",{onClick:v,className:""===o?"submit-comment-btn disabled":"submit-comment-btn"},"Send"))})),B=n(215),F=n(8),V=n(73),z=n(29),J=n(1269),Q=n(38),Y=n(46);function _(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var K=(new J.a).contractAddress,X=L.a.utils.padLeft("0x0",64),Z=function(){return new Q.a(K)},ee=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new V.a(Y.e,"deleteList",[Object(M.c)(t)]).execute();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new V.a(Y.e,"bulkEdit",[t.map(function(e){return Object(M.c)(e)}),n.map(function(e){return e?Object(M.c)(e):X}),r.map(function(e){return L.a.utils.fromAscii(e)}),a]).execute();case 2:case"end":return e.stop()}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),ne=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Z().from(z.g).select("newContent").select("previousContent").select("title"),e.t0=re,e.t1=ae,e.next=5,t.executeQuery();case 5:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.next=9,(0,e.t0)(e.t3);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.map(function(e){return e.newContent}),n=Z().from(z.f).select("contentHash"),e.t0=Set,e.next=5,n.executeQuery();case 5:return e.t1=e.sent.map(function(e){return e.contentHash}),r=new e.t0(e.t1),e.abrupt("return",t.filter(function(e){return!r.has(e.newContent)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t,n={},r=_(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.previousContent&&a.previousContent!==a.newContent&&(n[a.newContent]=a.previousContent)}}catch(f){r.e(f)}finally{r.f()}var c,o={},i=_(e);try{for(i.s();!(c=i.n()).done;){var s=c.value,u=ce(s.newContent,n);u in o||(o[u]=[]),o[u].push(s)}}catch(f){i.e(f)}finally{i.f()}var l=[];for(var d in o)o[d].sort(function(e,t){return t.blockNumber-e.blockNumber}),l.push(o[d][0]);return l},ce=function e(t,n){var r=n[t];return void 0===r?t:e(r,n)};function oe(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var se=Object(f.b)(function(e,t){return{unpublished:e.explore.unpublished}},function(e){return{setExploreUnpublished:function(t){return e(Object(d.mc)(t))}}})(function(e){var t=e.setExploreUnpublished,n=e.unpublished;Object(s.useEffect)(function(){var e=l.a.getItem("unsavedLists");e&&t(JSON.parse(e))},[]);var r=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var r,a,o,i,s,u,d,f,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],o=[],i=[],s=oe(n),e.prev=5,s.s();case 7:if((u=s.n()).done){e.next=21;break}return d=u.value,e.next=11,m.a.addJson(d);case 11:f=e.sent,p=d.hash,d.hash=f,d.newContent=f,r.push(f),a.push(p),o.push(d.name),i.push(0);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),s.e(e.t0);case 26:return e.prev=26,s.f(),e.finish(26);case 29:l.a.setItem("publishingLists",JSON.stringify(n)),l.a.removeItem("unsavedLists"),te(r,a,o,i),t(void 0);case 33:case"end":return e.stop()}},e,null,[[5,23,26,29]])})),[n]);return n&&0!==n.length?u.a.createElement("div",{onClick:r,className:"save-unpublished-btn"},"Publish Changes ",u.a.createElement("span",{className:"unpublished-count"},n.length)):u.a.createElement("div",null)}),ue=n(40),le=n(420),de=Object(f.b)(function(e,t){return{projectDragging:e.explore.projectDragging}},function(e){return{setProjectDragging:function(t){return e(Object(d.ye)(t))},setExploreUnpublished:function(t){return e(Object(d.mc)(t))}}})(function(e){var t=e.hide,n=e.projectDragging,r=e.setProjectDragging,a=e.list,d=e.setExploreUnpublished,f=e.onDelete,m=Object(s.useState)(""),p=Object(i.a)(m,2),v=p[0],h=p[1],b=Object(s.useState)([]),g=Object(i.a)(b,2),k=g[0],E=g[1],O=Object(s.useState)(void 0),j=Object(i.a)(O,2),S=j[0],y=j[1],x=Object(s.useState)(void 0),C=Object(i.a)(x,2),q=C[0],N=C[1];Object(s.useEffect)(function(){a&&(E(a.projects),h(a.name),y(a.image))},[a]);var T=Object(s.useCallback)(function(e){n&&(E([].concat(Object(w.a)(k),[n])),r(void 0))},[n,k,E]),L=Object(s.useCallback)(function(e){if(q){var t=k.indexOf(q),n=Object(w.a)(k);n.splice(t,1);var r=n.indexOf(e);n=[].concat(Object(w.a)(n.slice(0,r)),[q],Object(w.a)(n.slice(r))),N(void 0),E(n)}},[q,E,k,N]),M=Object(s.useCallback)(function(e){var t=k.indexOf(e),n=Object(w.a)(k);n.splice(t,1),E(n)},[k,E]),I=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n,r,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={name:v,title:v,projects:k,image:S,id:Object(ue.uuid)()},a&&(n.hash=a.newContent,n.newContent=a.newContent),r=(r=l.a.getItem("unsavedLists"))?JSON.parse(r):[],!(a&&r.length>0)){e.next=16;break}e.t0=c.a.keys(r);case 6:if((e.t1=e.t0()).done){e.next=14;break}if(o=e.t1.value,!((i=r[o]).name===a.name||a.hash&&i.hash===a.hash)){e.next=12;break}return r[o]=n,e.abrupt("break",14);case 12:e.next=6;break;case 14:e.next=17;break;case 16:r.push(n);case 17:s=JSON.stringify(r),l.a.setItem("unsavedLists",s),d(r),t(n);case 21:case"end":return e.stop()}},e)})),[v,k,S,t,a]);return u.a.createElement("div",{className:"new-list"},u.a.createElement("div",{onDrop:T,onDragOver:function(e){return e.preventDefault()},className:"inner"},u.a.createElement("input",{placeholder:"Type name for list",value:v,onChange:function(e){return h(e.target.value)},type:"text"}),u.a.createElement("div",{className:"projects"},k.map(function(e){return u.a.createElement("div",{key:e.newSequence,onDrop:function(){return L(e)},onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return N(e)},draggable:!0,className:"project"},u.a.createElement("div",{className:"project-name"},e.title),u.a.createElement("div",{onClick:function(){return M(e)},className:"delete-btn"},"x"))})),u.a.createElement("div",{className:"drop-here"},u.a.createElement("span",null,"Drop projects here")),u.a.createElement("div",{className:"btns"},u.a.createElement("div",{onClick:I,className:"done-btn"},"Done"),u.a.createElement("div",{onClick:function(){return t()},className:"cancel-btn"},"Cancel"))),u.a.createElement("div",{className:"inner"},u.a.createElement(le.a,{imageHash:S,setImageHash:y}),a?u.a.createElement("div",{onClick:function(){window.confirm("Confirm delete")&&f()},className:"delete-list-btn"},"Delete List"):""))}),fe=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.loadWork,n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)(!1),l=Object(i.a)(o,2),d=l[0],f=l[1],p=Object(s.useState)(Object(F.a)({},e.list)),v=Object(i.a)(p,2),h=v[0],b=v[1],g={backgroundImage:"url("+m.a.getHashUrl(h.image)+")"};Object(s.useEffect)(function(){C.a.getAccount().then(function(e){e&&(h.user?c(e.toLowerCase()===h.user.toLowerCase()):c(!0))})},[c]);var k=Object(s.useCallback)(function(t){t&&(b(t),e.onListChanged(t)),f(!1)},[b,f]),E=Object(s.useCallback)(function(t){var n="project";return e.worksLoaded.some(function(e){return e.newSequence===t.newSequence})&&(n+=" loaded"),n},[e.worksLoaded]);return Object(s.useEffect)(function(){e.list.projects[0]&&0===e.worksLoaded.length&&t(h.projects[0])},[]),d?u.a.createElement(de,{onDelete:e.onDelete,list:h,hide:k}):u.a.createElement("div",{style:g,className:"list"},a?u.a.createElement("div",{onClick:function(){return f(!0)},className:"edit-button"},"Edit"):"",u.a.createElement("div",{className:"projects"},h.projects.map(function(e){return u.a.createElement("div",{onClick:function(){return t(e)},className:E(e)},e.title)})),u.a.createElement("div",{className:"list-title"},h.name),u.a.createElement("div",{onClick:e.removeList,className:"delete-btn"},"x"))}),me=(n(2855),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.creatingNewList,n=e.lists,r=(e.hide,e.loadWork),a=e.removeList,c=e.onListChanged;return u.a.createElement("div",{className:"lists-container"},n.map(function(e,t){return u.a.createElement(fe,{onListChanged:c,onDelete:function(){c(e,!0),a(e)},removeList:function(){return a(e)},key:e.name,loadWork:r,list:e})}),t?u.a.createElement(de,{hide:c}):"",u.a.createElement(se,null))})),pe=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected}},function(e){return{setPersonSelected:function(t){return e(Object(d.kc)(t))}}})(function(e){var t=e.onNewList,n=e.personSelected,r=e.setPersonSelected,a=e.children,c=Object(s.useState)(void 0),o=Object(i.a)(c,2),l=o[0],d=o[1],f=Object(s.useState)(!1),m=Object(i.a)(f,2),p=m[0],v=m[1];return Object(s.useEffect)(function(){n?T.a.users.getUserName(n).then(d):d(void 0)},[n,d]),u.a.createElement("div",{className:"explore-toolbar"},u.a.createElement("div",{className:"toolbar-btn"},u.a.createElement(G.c,{className:"view-dropdown",show:p?"true":"false",isOpen:p,toggle:function(){return v(!p)}},u.a.createElement(G.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("img",{className:"explore-commands-icon",src:"/automation-icon-disabled.png"})),u.a.createElement(G.e,null,u.a.createElement(G.d,{onClick:t,key:"",size:"sm"},"New List")))),l?u.a.createElement("div",{onClick:function(){return r(void 0)},className:"user-selected"},l):"",a)}),ve=function(e){var t=e.work,n=(e.numPending,Object(s.useState)([])),r=Object(i.a)(n,2),a=r[0],c=r[1];return Object(s.useEffect)(function(){t&&T.a.xanadu.getAnnotations(N.c,t.newSequence).then(function(e){return c(Array.from(new Set(e.map(function(e){return e.annotationData}))))})},[c,t]),{newTag:Object(s.useCallback)(function(e){""!==e.trim()&&(T.a.xanadu.newAnnotation(N.c,t.newSequence,e),c([].concat(Object(w.a)(a),[e])))},[t,a,c]),tags:a,setTags:c}},he=Object(f.b)(null,null)(function(e){var t=e.work,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useRef)(void 0),l=ve({work:t}),d=l.newTag,f=l.setTags,m=l.tags,p=Object(s.useCallback)(function(e){c(e.target.value)},[c]);Object(s.useEffect)(function(){o.current&&o.current.focus()},[]);var v=Object(s.useCallback)(function(){d(a),c("")},[c,a,m,t,f]);return u.a.createElement("div",{className:"tags-editor"},u.a.createElement("div",{className:"input-container"},u.a.createElement("input",{ref:o,placeholder:"Type tag here",className:"tags-input",type:"text",onChange:p,value:a}),u.a.createElement("div",{onClick:v,className:"tag-button"},"Tag")),u.a.createElement("div",{className:"work-tags"},m.map(function(e){return u.a.createElement("div",{className:"work-tag"},e)})))}),be=function(e){var t=e.edit,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1];return Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(function(e){return c(e)})},[t,c]),Object(s.useEffect)(function(){T.a.getBlockDate(t.blockNumber).then(function(e){return f(e.toISOString().substring(0,10))})},[f,t]),u.a.createElement("div",{className:"sequence-edit"},u.a.createElement("div",{className:"title"},t.title," -"),u.a.createElement("div",{className:"author"},a),u.a.createElement("div",{className:"date"},d))},ge=Object(f.b)(function(e,t){return{allSequences:e.explore.allSequences}},null)(function(e){var t=e.work,n=e.allSequences,r=Object(s.useState)([]),a=Object(i.a)(r,2),c=a[0],o=a[1];Object(s.useEffect)(function(){var e=T.a.getEditsForSequence(t.newSequence,n);console.log("edits = ",e),o(e)},[o,t,n]);return u.a.createElement("div",null,u.a.createElement("div",{className:"sequence-edits"},c.map(function(e){return u.a.createElement(be,{edit:e})})),u.a.createElement("div",{onClick:function(){window.open("/create/"+t.newSequence)},className:"new-edit-button"},"Create New Edit"))}),ke=n(2718),Ee=(n(2856),function(e){var t=e.annotationsView;if(!t)return u.a.createElement("div",null);var n=["ANNOTATION","TAGS","EDITS"];return u.a.createElement("div",null,u.a.createElement(Oe,{annotationsView:t,linkType:n[0],linkNumber:0},u.a.createElement(ke.a,{work:t})),u.a.createElement(Oe,{annotationsView:t,linkType:n[1],linkNumber:1},u.a.createElement(he,{work:t})),u.a.createElement(Oe,{annotationsView:t,linkType:n[2],linkNumber:2},u.a.createElement(ge,{work:t})))}),Oe=function(e){var t=e.annotationsView,n=e.linkNumber,r=e.linkType,a=e.children,c={left:130+220*n},o=[210+250*t.workNumber,0,130+220*n,80,330+220*n,80];return console.log("points = ",o,t),u.a.createElement("div",null,u.a.createElement("svg",{className:"annotations-svg "+r,height:"80",width:"1000"},u.a.createElement("polygon",{points:o})),u.a.createElement("div",{style:c,className:"annotations-view "+r},a))},je=0,we=function(e){var t=e.hideText,n=e.searchOptions,r=e.option,a=e.onClickOption,c=e.baseClass,o=void 0===c?"search-option":c,i=e.selectedClass,s=void 0===i?"selected":i;return u.a.createElement("div",{onClick:function(){return a(r)},className:n.indexOf(r)>-1?o+" "+s:o},t?"":"Starred"===r?u.a.createElement("span",null,"\u2606"):r)},Se=function(e){e.searchTerm;var t=e.setSearchTerm,n=e.setSearchOptions,r=e.searchOptions,a=e.setSearchTag,c=e.searchTag,o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useCallback)(function(e){var a=++je,c=e.target.value;setTimeout(function(){je===a&&(t(c),(r.includes("Starred")||r.includes("Favorited"))&&n(r.filter(function(e){return"Starred"!==e&&"Favorited"!==e})))},750),f(e.target.value)},[f,t,r,n]),p=Object(s.useCallback)(function(e){if(-1==r.indexOf(e))n("Lists"===e||"Projects"===e?[e]:[e].concat(Object(w.a)(r)));else{var t=r.filter(function(t){return t!==e});console.log("setting search options = ",t),n(t)}},[r,n]);return u.a.createElement("div",{className:"explore-search-container"},c?u.a.createElement("div",{onClick:function(){return a(void 0)},className:"search-tag"},c):"",u.a.createElement("div",{className:"heart-and-soul"},u.a.createElement(we,{hideText:!0,baseClass:"heart",selectedClass:"favorited",onClickOption:p,searchOptions:r,option:"Favorited"}),u.a.createElement("div",null),u.a.createElement(we,{baseClass:"star",selectedClass:"starred",onClickOption:p,searchOptions:r,option:"Starred"})),u.a.createElement(we,{onClickOption:p,searchOptions:r,option:"Lists"}),u.a.createElement(we,{onClickOption:p,searchOptions:r,option:"Projects"}),u.a.createElement("input",{type:"text",value:d,onChange:m,className:"explore-search",placeholder:"Type to search"}),u.a.createElement("div",{onClick:function(){t(""),f(""),a(void 0)},className:"search-clear-btn"},"x"))},ye=n(1423),xe=n(1169),Ce=n(45),qe=n(67),Ne=n(2548),Te=n(541),Le=n(393),Me=n(3),Ie=n(7),Ae=n(11),De=n(1),Re=n(2602),Pe=n(4);n(87);function We(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(De.a)(e);if(t){var a=Object(De.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(Ae.a)(this,n)}}var He=n(2657);function Ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(De.a)(e);if(t){var a=Object(De.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(Ae.a)(this,n)}}var Ue=function(e){Object(Ie.a)(n,e);var t=Ge(n);function n(){return Object(Me.a)(this,n),t.apply(this,arguments)}return n}(function(e){Object(Ie.a)(n,e);var t=We(n);function n(){return Object(Me.a)(this,n),t.apply(this,arguments)}return Object(Pe.a)(n,[{key:"saveMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var r,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,C.a.getAccount();case 3:return e.t1=e.sent,e.t2=this.events,e.t3=this.worksLoaded,e.t4=this.initialState,r={title:e.t0,user:e.t1,events:e.t2,works:e.t3,initialState:e.t4},n=void 0===n?L.a.utils.padLeft("0x0",64):Object(M.c)(n),e.next=11,m.a.addJson(r);case 11:return a=e.sent,o=this.worksLoaded.map(function(e){return Object(M.c)(e.newSequence)}),new V.a(Y.o,"newMix",[Object(M.c)(a),n,t,o,0]).execute(),e.abrupt("return",r);case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOAD MIX CALLED!"),this.unloadAll(),this.events=t.events,this.initialState=t.initialState||{worksLoaded:t.works},this.store.dispatch(Object(d.ic)(t)),console.log("mix loaded =",t),n=Array.from(new Set([].concat(Object(w.a)(this.initialState.worksLoaded),Object(w.a)(t.works)))),e.t0=c.a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=15;break}return r=e.t1.value,console.log("loading work =",n[r]),e.next=13,this.loadWork(n[r]);case 13:e.next=8;break;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearMix",value:function(){this.clearScheduledEvents(),this.initialState=void 0,this.events=[],this.store.dispatch(Object(d.ic)(void 0))}}]),n}(Object(Re.a)(He.a))),Be=n(1422),Fe=n(1122),Ve=n(2540),ze=n(1119),Je=function(e){var t=e.name,n=e.option,r=e.selected,a=e.onClick,c="option";return r&&(c+=" selected"),u.a.createElement("div",{onClick:function(){return a(n)},className:c},t)},Qe=Object(f.b)(function(e){return{selectedRecord:e.discover.selectedRecord,selectedGuild:e.guilds.selectedGuild,showLogin:e.sequencer.showLogin,option:e.explore.exploreOption,userToken:e.sequencer.userToken}},function(e){return{setOption:function(t){return e(Object(d.jc)(t))}}})(function(e){e.setSearchTerm,e.searchTerm;var t=e.store,n=e.showLogin,r=e.option,a=e.setOption,c=(e.searchOptions,e.setSearchOptions,Object(s.useState)(!1)),o=Object(i.a)(c,2),l=o[0],d=o[1],f="navigation";return C.a.isLoggedIn()||(f+=" logged-off"),u.a.createElement("div",{className:f},u.a.createElement(Je,{name:"Home",option:xe.b,selected:r===xe.b,onClick:a}),u.a.createElement(Je,{name:"Guilds",option:xe.a,selected:r===xe.a,onClick:a}),u.a.createElement(Je,{name:"Messages",option:xe.c,selected:r===xe.c,onClick:a}),u.a.createElement("div",{onClick:function(){return d(!0)},className:"preferences-btn"},"Preferences"),u.a.createElement(ze.a,{store:t}),u.a.createElement(Ve.a,null),u.a.createElement(Fe.a,{show:n}),l?u.a.createElement(Be.a,{hide:function(){return d(!1)},onlyAppearance:!0}):"")}),Ye=function(e){var t=e.person,n=e.selected,r=e.onClick,a=t.userName,c=t.id,o=n?"person selected":"person";return u.a.createElement("div",{onClick:r,className:o},u.a.createElement("div",{className:"name"},a||c))},_e=(n(1148),function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),$e=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r,a,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n=new Set,t)n.add(t[r].user);n=Array.from(new Set(n)),a=[],e.t0=c.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=14;break}return o=e.t1.value,i=n[o].trim(),e.next=10,T.a.users.getUserName(i);case 10:s=e.sent,a.push({id:i,userName:s}),e.next=5;break;case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Ke=(Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences}},function(e){return{setPersonSelected:function(t){return e(Object(d.kc)(t))}}})(function(e){var t=e.personSelected,n=e.setPersonSelected,r=e.allSequences,a=Object(s.useState)([]),c=Object(i.a)(a,2),o=c[0],l=c[1];Object(s.useEffect)(function(){_e(r).then(function(e){return l(e)})},[l,r]);var d="";return t&&(d=u.a.createElement(Ye,{onClick:function(){return n(void 0)},selected:!0,person:t})),u.a.createElement("div",{className:"people"},d,u.a.createElement("div",{className:"people-to-choose"},o.filter(function(e){return!t||t.id!==e.id}).map(function(e){return u.a.createElement(Ye,{onClick:function(){return n(e)},key:e.id,person:e})})))}),n(965)),Xe=function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a,o,i){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ke.a)(r,void 0,t,n,a,!1,o,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n,r,a,c,o){return e.apply(this,arguments)}}(),Ze=(n(494),n(209)),et=n(1268),tt=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Q.a((new et.a).contractAddress).from(z.A).select("mixHash").select("previousHash").select("title").select("user"),e.next=3,t.executeQuery(!1);case 3:return n=e.sent,console.log("mix results =",n),e.abrupt("return",n.map(function(e){return Object(F.a)({},e,{type:"MIX"})}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function nt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,r,a,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:t=e.sent,n=[],r=nt(t);try{for(r.s();!(a=r.n()).done;)o=a.value,n.push(Object(F.a)({},o,{hash:o.newContent,tags:[],type:"LIST"}))}catch(c){r.e(c)}finally{r.f()}if(i=l.a.getItem("unsavedLists")){e.next=9;break}return e.abrupt("return",n);case 9:return i=JSON.parse(i),n=n.filter(function(e){return!i.some(function(t){return t.hash===e.hash})}),e.abrupt("return",[].concat(Object(w.a)(n),Object(w.a)(i.map(function(e){return Object(F.a)({},e,{id:void 0!==e.id?e.id:Object(ue.uuid)(),title:e.name,unsaved:!0,tags:[],blockNumber:9999999999,type:"LIST"})}))));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ct=(new Ze.a,function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a,o,i,s){var u,l,d,f,m,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("person selecred == ",s),u=r.includes("Favorited"),l=r.includes("Starred"),e.next=5,Xe(l,u,a,o,i,s);case 5:return d=e.sent.map(function(e){return Object(F.a)({},e,{type:"SEQUENCE"})}),e.next=8,tt();case 8:return f=e.sent,e.next=11,at();case 11:m=e.sent,(p=[].concat(Object(w.a)(m),Object(w.a)(f),Object(w.a)(d))).sort(function(e,t){return t.blockNumber-e.blockNumber}),t(Object(w.a)(p)),n(!1);case 16:case"end":return e.stop()}},e)}));return function(t,n,r,a,c,o,i){return e.apply(this,arguments)}}()),ot=Object(f.b)(function(e,t){return{exists:t.sequencerEngine.events.length>0}},null)(function(e){var t=e.sequencerEngine,n=e.exists,r=e.originalMix,a=Object(s.useState)(void 0),l=Object(i.a)(a,2),d=l[0],f=l[1],m=Object(s.useState)(""),p=Object(i.a)(m,2),v=p[0],h=p[1],b=Object(s.useState)(""),g=Object(i.a)(b,2),k=g[0],E=g[1],O=Object(s.useCallback)(function(){t.clearMix(),f(void 0)},[f]);Object(s.useEffect)(function(){r&&T.a.users.getUserName(r.user).then(function(e){return E(e)})},[r]);var j=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveMix(r?r.title:v,r&&r.mixHash);case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}},e)})),[v,f,r]);return n?r?u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"edit-text"},"Edit of ",u.a.createElement("span",{className:"mix-title"},r.title)," by ",u.a.createElement("span",{className:"mix-author"},k)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"mix-title"},void 0===d?u.a.createElement("input",{placeholder:"Enter mix name",className:"mix-input",type:"text",value:v,onChange:function(e){return h(e.target.value)}}):u.a.createElement("div",null,d.title)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):[]}),it=n(109),st=n.n(it),ut=Object(f.b)(function(e,t){return{bpm:e.user.bpm}},null)(function(e){var t=e.bpm,n=e.sequencerEngine;return u.a.createElement("div",{className:"bpm-container"},u.a.createElement("div",{className:"bpm-label"},"BPM: ",Math.round(t)),u.a.createElement(st.a,{value:t,change:function(e){return n.dispatch(Object(Ne.a)(e.target.value))},step:1,className:"bpm-fader",max:250,min:1,orientation:"horizontal",reversed:!1}))}),lt=n(607),dt=Object(f.b)(function(e){return{playingMap:e.sequencer.isPlaying,isRecordingMix:e.mix.isRecordingMix}},function(e){return{setRecordingExploreMix:function(t){return e(Object(d.Oc)(t))}}})(function(e){var t=e.sequencerEngine,n=e.isRecordingMix,r=e.playingMap,a=e.setRecordingExploreMix,c=Object.keys(r).filter(function(e){return r[e]}).length>0,o=Object(s.useCallback)(function(){a(!n)},[n,a]),i=Object(s.useCallback)(function(e){t.playMix(!c)},[t,c]);return u.a.createElement("div",{className:"work-mix-buttons"},u.a.createElement(lt.a,{isPlaying:c,play:i}),u.a.createElement("div",{onClick:o,className:n?"recording-dot":"not-recording-dot"}))}),ft=n(2565),mt=n(1163),pt=function(e){var t=e.sequencerEngine,n=e.children;return u.a.createElement("div",{className:"mixer-toolbar-container"},u.a.createElement("div",{className:"mixer-toolbar"},u.a.createElement(ut,{sequencerEngine:t}),u.a.createElement(dt,{sequencerEngine:t}),u.a.createElement(ft.a,{sequencerEngine:t.headSequencerEngine}),u.a.createElement(mt.a,{sequencerEngine:t})),n)},vt=n(1072),ht=n(1412),bt=(new b.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.showComments,r=e.setSearchTag,a=e.editTags,c=void 0===a||a;t.id=t.newSequence;var o=Object(s.useState)([t]),l=Object(i.a)(o,2),d=l[0],f=(l[1],R({works:d}).comments),m=Object(s.useState)(!1),p=Object(i.a)(m,2),v=p[0],h=p[1],b=ve({work:t}).tags,g=Object(ht.a)({track:t}),k=g.isStarred,E=g.showStar,O=g.isFavorited,j=g.onStarClicked,w=g.onFavoriteClicked,S=Object(s.useCallback)(function(e,t){e.stopPropagation(),r(t)},[r]),y="work-metadata";return v&&(y+=" showing-tags"),u.a.createElement("div",{className:y},u.a.createElement("div",{className:"metadata-inner"},u.a.createElement("div",{className:"work-tags"},c?"":b.filter(function(e){return e}).map(function(e){return u.a.createElement("div",{onClick:function(t){return S(t,e)},className:"work-tag"},e)})),v?u.a.createElement(he,{work:t}):"",u.a.createElement("img",{onClick:function(){return h(!v)},className:v?"show tag-icon":"tag-icon",src:"/tag.svg"}),n&&f.length>0?u.a.createElement("img",{className:"comments-icon",src:"/comments.svg"}):"",u.a.createElement(Ce.a,{condition:E},u.a.createElement("div",{onClick:j,className:k?"star starred":"star"},u.a.createElement("span",null,"\u2606"))),u.a.createElement("div",{onClick:w,className:O?"heart favorited":"heart"})))})),gt=(n(1386),n(1166)),kt=["A","B","C","D","E","F","G","H","I","J"],Et=Object(f.b)(function(e,t){var n=t.sequencerEngine.engineId;t.sequencerEngine.currentSubSequence.id;return{currentSubSequence:e.sequencer.currentSubSequence[n],subSequences:e.sequencer.subSequences[n]}},null)(function(e){var t=e.sequencerEngine,n=e.currentSubSequence,r=e.subSequences;return u.a.createElement("div",{className:"sub-sequences"},r.map(function(e,r){return u.a.createElement("div",{onClick:function(){return t.switchToSubSequence(e)},className:e===n?"sub-sequence current":"sub-sequence"},kt[r])}))}),Ot=n(2656),jt=-70,wt=6;var St=Object(f.b)(function(e,t){return{masterVolume:e.sequencer.masterVolumes[t.id]}},null)(function(e){var t=e.masterVolume,n=(e.id,e.multiSequencerEngine),r=e.sequencerEngine,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt;return Math.pow((e-t)/(n-t),4)}(t),c=Object(s.useCallback)(function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt,r=Math.pow(e,.25);return t+(n-t)*r}(e.target.value);n.dispatch(Object(Ne.d)(r.sequenceId,t))},[r,n]);return u.a.createElement("div",{className:"work-volume-container"},u.a.createElement(st.a,{value:a,change:c,step:.01,className:"work-fader",max:1,min:0,orientation:"vertical",reversed:!0}))}),yt=n(787),xt=new b.a,Ct=Object(f.b)(function(e,t){return{value:e.explore.workTransposes[t.sequencerEngine.sequenceId]||0}},null)(function(e){var t=e.sequencerEngine,n=e.value,r=e.id,a=Object(s.useCallback)(function(e){(e=Math.round(e))!==n&&t.multiSequencerEngine.dispatch(Object(Ne.c)(t.sequenceId,e))},[t,n]),c=xt.getColorForHash(r||"what");return u.a.createElement("div",{className:"transpose-container"},u.a.createElement(yt.Knob,{size:50,angleOffset:220,angleRange:280,value:n,initialValue:n,step:1,min:-24,max:24,onChange:a},u.a.createElement(yt.Arc,{arcWidth:3,color:c,background:"rgb(56, 63, 72)"}),u.a.createElement(yt.Pointer,{width:3,height:15,radius:10,type:"rect",color:c}),u.a.createElement(yt.Value,{className:"transpose-value"})))}),qt=new b.a;var Nt=Object(f.b)(function(e,t){return{value:e.explore.mixColorValues[t.id]}},function(e,t){return{setColorValue:function(n){return e(Object(d.pd)(t.id,n))}}})(function(e){var t=e.value,n=void 0===t?.5:t,r=(e.setColorValue,e.mixEffects,e.sequencerEngine),a=e.id,c=Object(s.useCallback)(function(e){r.multiSequencerEngine.dispatch(Object(Ne.b)(a,e))},[]),o=qt.getColorForHash(a||"what");return u.a.createElement("div",{className:"color-container"},u.a.createElement(yt.Knob,{size:50,angleOffset:220,angleRange:280,value:n,min:0,max:1,onChange:function(e){return c(e)}},u.a.createElement(yt.Arc,{arcWidth:3,color:o,background:"rgb(56, 63, 72)"}),u.a.createElement(yt.Pointer,{width:3,height:15,radius:10,type:"rect",color:o})))}),Tt=new b.a,Lt=Object(f.b)(function(e,t){return{isLoading:e.sequencer.loadingSequence[t.work.newSequence],isPlaying:e.sequencer.isPlaying[t.work.newSequence],isAnnotationShowing:e.explore.exploreWork===t.work,worksLoaded:e.explore.worksLoaded}},function(e){return{setExploreWork:function(t){return e(Object(d.nc)(t))},setProjectDragging:function(t){return e(Object(d.ye)(t))}}})(function(e){var t=e.workNumber,n=e.work,r=e.sequencerEngine,a=e.isLoading,c=e.isPlaying,o=e.unloadWork,l=e.setExploreWork,d=e.isAnnotationShowing,f=e.setProjectDragging,m=Object(s.useState)(""),p=Object(i.a)(m,2),v=p[0],h=p[1],b=r.idToSequencerEngine[n.newSequence],g=Object(s.useState)(n.title),k=Object(i.a)(g,2),E=k[0],O=k[1],j=Object(s.useState)(void 0),w=Object(i.a)(j,2),S=w[0],y=w[1];Object(s.useEffect)(function(){n.guildId&&T.a.guildSequences._decryptQueryResult(n).then(function(e){return O(e.title)})},[n,O]),Object(s.useEffect)(function(){b&&b._wallpaper&&Object(vt.a)(b._wallpaper).then(function(e){e&&e[0]&&y(e[0].thumbnail)})},b&&b._wallpaper),Object(s.useEffect)(function(){T.a.users.getUserName(n.user).then(function(e){return h(e)})},[n]);if(a||!b)return u.a.createElement("div",{className:"work-mixer loading"},u.a.createElement(gt.a,{width:200,id:n.newSequence}),u.a.createElement("div",{onClick:o,className:"delete-button"},"x"));var x=Tt.getColorForHash(n.newSequence),C={backgroundColor:x};n.workNumber=t;var q={};return S&&(q.backgroundImage="url(/ipfs/"+S+")"),u.a.createElement("div",{className:"work-mixer-container"},u.a.createElement("div",{style:{},className:"work-mixer"},u.a.createElement("div",{style:q,className:"inner"},u.a.createElement(St,{multiSequencerEngine:r,sequencerEngine:b,id:n.newSequence}),u.a.createElement("div",{className:"work-fields"},u.a.createElement(Et,{sequencerEngine:b}),u.a.createElement(Ot.a,{color:x,sequencerEngine:b}),u.a.createElement("div",{className:"cassette"},u.a.createElement(Ct,{id:n.newSequence,sequencerEngine:b}),u.a.createElement(Nt,{mixEffects:b.channelMixer.mixEffects,sequencerEngine:b,id:n.newSequence})))),u.a.createElement("div",{draggable:!0,onDragStart:function(){return f(n)},onDragOver:function(e){return e.preventDefault()},className:"bottom"},u.a.createElement("div",{style:C,className:"play-button"},u.a.createElement(lt.a,{color:Tt.getColorForHash(n.newSequence),isPlaying:c,play:function(){var e=Object(F.a)({},n,{id:n.newSequence});r.dispatch(Object(Ne.f)(e))}})),u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"work-title"},E),u.a.createElement("div",{className:"author-divider"},"-"),u.a.createElement("div",{className:"work-author"},u.a.createElement("div",{className:"author-label"},"Author"),u.a.createElement("div",{className:"author-name"},v))),u.a.createElement("img",{onClick:function(){return l(d?void 0:n)},src:"/annotations.png",className:d?"annotation-button showing":"annotation-button"}),u.a.createElement("div",{style:C,onClick:function(){l(void 0),o()},className:"delete-button"},"x")),u.a.createElement(bt,{work:n})))}),Mt=function(e){var t=e.recording,n=e.setDeleting,r=e.deleting,a=e.onClickRecord,c="button-option";t&&(c+=" selected");var o="button-option";return r&&(o+=" selected"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:a,className:c},"Rec"),u.a.createElement("div",{onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)},className:o},"Del")))},It=n(35),At=n(333),Dt=n(61),Rt=n(476),Pt=new b.a,Wt=new It.a(32,!1),Ht=(new Dt.a,function(e){var t=e.track,n=e.setLastClicked,r=e.selected,a=e.recording,c=t.instrument,o=Object(s.useState)(void 0),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useState)(0),p=Object(i.a)(m,2),v=p[0],h=p[1],b=Object(s.useState)(0),g=Object(i.a)(b,2),k=g[0],E=g[1],O=v>k,j=c.defaultSampler&&c.defaultSampler.sample,w=Object(s.useCallback)(function(){t.sequencerEngine.state.keyboard.isCommandDown?n(t):(c.defaultSampler.loop&&O?c.triggerRelease():c.triggerAttack(),a&&f(new Rt.a(t,0,Wt,t.sequencerEngine,!0)),n(t))},[c,t,a,f,O]),S=Object(s.useCallback)(function(){t.gated&&c.triggerRelease(),a&&d&&(d.record(),f(void 0))},[c,t,a,d,f]),y=Object(s.useCallback)(function(e){e.trackNumber===t.trackNumber&&setTimeout(function(){h((new Date).getTime()+e.duration),e.duration>0&&setTimeout(x,1e3*e.duration)},e.time)},[t,h,x]),x=Object(s.useCallback)(function(e){void 0!==e&&e.trackNumber!==t.trackNumber||E((new Date).getTime())},[t,E]),C=function(){window.removeEventListener(At.d,y),window.removeEventListener(At.c,x)};Object(s.useEffect)(function(){return window.addEventListener(At.d,y),window.addEventListener(At.c,x),C},[]);var q="sampler-trigger";if(O&&(q+=" triggering"),r&&(q+=" selected"),j&&j.videoId)return u.a.createElement("img",{draggable:!1,onMouseDown:w,onMouseUp:S,onMouseLeave:S,className:q,src:j.getThumbnail()});var N={backgroundColor:Pt.getColorForTrack(t)};return u.a.createElement("div",{draggable:!1,onMouseDown:w,onMouseUp:S,onMouseLeave:S,style:N,className:q})}),Gt=n(152),Ut=new b.a,Bt=function(e){var t=e.lastClicked,n=e.deleteSample,r=(e.recording,e.onClickRecord,Object(s.useState)(!1)),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(!1),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useState)(!1),v=Object(i.a)(p,2),h=(v[0],v[1]),b=Object(s.useState)(1),g=Object(i.a)(b,2),k=g[0],E=g[1],O=Object(s.useCallback)(function(){t.instrument.loopParameter.set(!f),m(!f)},[m,f,t]),j=Object(s.useCallback)(function(){t.gated=!c,o(!c)},[o,c,t]),w=Object(s.useCallback)(function(){var e=2*k;8===e&&(e=1),t.pattern.changeLength(32*e),E(e)},[E,k,t]);if(Object(s.useEffect)(function(){t&&(o(t.gated),m(t.instrument.loop),h(t.isWarped()),E(t.length/32))},[t,o,m,h,E]),void 0===t)return[];var S="button-option",y="button-option",x=Ut.saturate(Ut.getColorForHash(t.instrument.defaultSampler.sample.getId()),3),C={},q={},N={backgroundColor:x,color:"black"};return f&&(y+=" selected",C.backgroundColor=x,C.color="black"),c&&(S+=" selected",q.backgroundColor=x,q.color="black"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"name"},t.instrument.defaultSampler.sample.name),u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:j,style:q,className:S},"Gate"),u.a.createElement("div",{onClick:O,style:C,className:y},"Loop"),u.a.createElement("div",{onClick:w,style:N,className:"button-option length-button"},k," Bars"),u.a.createElement("div",{onClick:n,className:"delete-button"},"x")),u.a.createElement("div",{className:"knobs"},u.a.createElement(Gt.a,{min:-40,max:0,color:x,parameter:t.volumeParameter}),u.a.createElement(Gt.a,{color:x,parameter:t.instrument.defaultSampler.transposeParameter})))},Ft=n(1074),Vt=function(e){var t=e.sequencerEngine,n=e.samplersLoaded,r=e.deleteSample,a=Object(s.useState)(!1),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(s.useState)(!1),f=Object(i.a)(d,2),m=f[0],p=f[1],v=Object(s.useState)(void 0),h=Object(i.a)(v,2),b=h[0],g=h[1];Object(s.useEffect)(function(){n[0]&&(n[0].sequencerEngine.deleting=m)},[m,n]);var k=Object(s.useCallback)(function(){l(!o)},[o,l]);if(0===n.length)return[];var E="";if(b){var O=b.instrument;E=u.a.createElement(Ft.a,{instrument:O,color:"#ffffff",sampler:O.defaultSampler,soundId:O.defaultSampler.sample.getId(),buffer:O.defaultSampler.sample.audioBuffer,width:150,height:40})}return u.a.createElement("div",{className:"sampler"},u.a.createElement("div",{className:"inner"},u.a.createElement(St,{multiSequencerEngine:t,sequencerEngine:n[0].sequencerEngine,id:n[0].sequencerEngine.sequenceId}),u.a.createElement("div",{className:"sampler-triggers"},n.map(function(e){return u.a.createElement(Ht,{key:e.id,recording:o,selected:b===e,setLastClicked:g,track:e})})),u.a.createElement("div",{className:"right-side"},E,u.a.createElement(Bt,{deleteSample:function(){g(void 0),r(b)},lastClicked:b}))),u.a.createElement(Mt,{setDeleting:p,deleting:m,recording:o,onClickRecord:k}))},zt=function(e){var t=e.work,n=e.onClick,r=e.mixMode,a=e.sequencerEngine,l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],v=Object(s.useState)({}),h=Object(i.a)(v,2),b=h[0],g=h[1],k=Object(s.useState)([]),E=Object(i.a)(k,2),O=E[0],j=E[1],w=Object(s.useState)({}),S=Object(i.a)(w,2),y=S[0],x=S[1];Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(function(e){return p(e)})},[t,p]),Object(s.useEffect)(function(){t&&(t.works?(x(t),j(t.works)):m.a.getJson(t.mixHash).then(function(e){e.mixHash=t.mixHash,j(e.works),x(e)}))},[t,j,x]),Object(s.useEffect)(function(){Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=c.a.keys(O);case 2:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=6,T.a.users.getUserName(O[n].user);case 6:t[O[n].user]=e.sent,e.next=2;break;case 9:g(t);case 10:case"end":return e.stop()}},e)}))()},[O,g]);var C="";r&&(C=u.a.createElement("div",{onClick:function(){a.unloadAll()},className:"delete-button"},"x"));var q=t.previousHash&&""!==t.previousHash;return u.a.createElement("div",{onClick:function(){return n(y)},className:"work work-mix"},C,u.a.createElement("div",{className:"mix-info"},O.map(function(e){return[e.title+" - ",u.a.createElement("span",{className:"work-author"},b[e.user])]})),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},f),u.a.createElement("div",{className:"title"},t.title),u.a.createElement("div",{className:"mix-edit-info"},q?"Edit":"Original"),u.a.createElement("div",{className:"mix-background"},"MIX")))},Jt=Object(f.b)(function(e,t){return{headSequencerEngine:t.sequencerEngine&&t.sequencerEngine.headSequencerEngine,mixLoaded:e.explore.mixLoaded,mixHasEdits:e.explore.mixHasEdits}},null)(function(e){var t=e.worksLoaded,n=e.sequencerEngine,r=e.unloadWork,a=e.samplersLoaded,c=e.deleteSample,o=e.mixLoaded,i=e.mixHasEdits,l=e.children,d=e.lists,f=Object(s.useCallback)(function(){n.unloadAll()},[n]);if(void 0===n)return u.a.createElement("div",null);var m="";return o&&(m=u.a.createElement(zt,{mixHasEdits:!0,sequencerEngine:n,mixMode:!0,onClick:f,work:o})),u.a.createElement("div",{className:"mixer no-select"},u.a.createElement("div",{className:"mixer-and-works"},u.a.createElement(pt,{sequencerEngine:n}),u.a.createElement("div",{className:"works-container"},t.map(function(e,t){return u.a.createElement(Lt,{workNumber:t,key:e.newSequence,unloadWork:function(){return r(e)},sequencerEngine:n,work:e})}),u.a.createElement(Vt,{sequencerEngine:n,deleteSample:c,samplersLoaded:a}),o?m:"",i?u.a.createElement(ot,{originalMix:o,sequencerEngine:n}):""),d),l)}),Qt=n(2638),Yt=n(2723),_t=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.onClick,r=Object(s.useState)(void 0),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],v=Object(s.useState)([]),h=Object(i.a)(v,2),b=h[0],g=h[1],k=Object(s.useState)(""),E=Object(i.a)(k,2),O=E[0],j=E[1];Object(s.useEffect)(function(){t.projects?(console.log("there was work.projects and work.image =",t.image),g(t.projects),j(m.a.getHashUrl(t.image)),o(Object(F.a)({},t))):m.a.getJson(t.newContent).then(function(e){o(Object(F.a)({},t,e)),j(m.a.getHashUrl(e.image)),g(e.projects)})},[t]),Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(p)},[t,p]);var w={backgroundImage:"url("+O+")"};return u.a.createElement("div",{onClick:function(){return n(c)},style:w,className:"work list"},u.a.createElement("div",{className:"projects"},b.map(function(e){return u.a.createElement("div",{className:"project"},e.title," .")})),u.a.createElement("div",{className:"list-author"},f),u.a.createElement("div",{className:"list-title"},t.title))}),$t=n(1125),Kt=(n(343),new b.a,n(1506)),Xt=n(1131);function Zt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tn=Object(s.memo)(function(e){var t=e.work,n=e.onClick,r=(e.loadSample,e.onClickMix),a=e.onClickList,l=e.setSearchTag,d=e.setProjectDragging,f=e.setPersonSelected,m=Object(s.useState)(""),p=Object(i.a)(m,2),v=p[0],h=p[1],b=Object(s.useState)(t.title),g=Object(i.a)(b,2),k=g[0],E=g[1],O=Object(s.useState)(!1),j=Object(i.a)(O,2),w=(j[0],j[1],Object(s.useState)([])),S=Object(i.a)(w,2),y=S[0],x=S[1],C=Object(s.useState)(void 0),q=Object(i.a)(C,2),N=q[0],L=q[1],M=Object(s.useState)(void 0),I=Object(i.a)(M,2),A=I[0],D=(I[1],Object(s.useState)([t])),P=Object(i.a)(D,2),W=P[0];P[1];t.id=t.newSequence,Object(s.useEffect)(function(){t.guildId&&T.a.guildSequences._decryptQueryResult(t).then(function(e){return E(e.title)})},[t,E]);R({works:W}).comments;if(Object(s.useEffect)(function(){"SEQUENCE"===t.type&&Object(Kt.a)(t).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.wallpaper,n=t.graphic,t.bpm,h(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[t]),Object(s.useEffect)(function(){Object($t.a)(t.blockNumber).then(L)},[t,L]),Object(s.useEffect)(function(){if(t.collaborators){var e,n=[],r=Zt(t.collaborators);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push(T.a.users.getUserName(a))}}catch(c){r.e(c)}finally{r.f()}Promise.all(n).then(x)}},[t,x]),"MIX"===t.type)return u.a.createElement(zt,{work:t,onClick:r}," ");if("LIST"===t.type)return u.a.createElement(_t,{onClick:a,work:t});var H=t.previousSequence&&""!==t.previousSequence,G={};A&&(G.backgroundImage="url(/ipfs/"+A+")");var U=void 0,B=void 0;if(N){var F=(new Date).getTime()-N.getTime();B=Math.ceil(F/1e3/60),U=Math.ceil(B/60)}return u.a.createElement("div",{draggable:!0,onDragStart:function(){return d(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return n(t)},className:"work"},u.a.createElement(bt,{setSearchTag:l,editTags:!1,showComments:!0,work:t}),u.a.createElement("div",{className:"graphic"},v),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},y.map(function(e,n){return u.a.createElement("div",{onClick:function(e){e.stopPropagation(),f(t.collaborators[n])},className:0===n?"collaborator origin":"collaborator"},e)})),u.a.createElement("div",{style:G,className:"work-thumb"}),u.a.createElement("div",{className:"work-title"},u.a.createElement("span",null,k))),u.a.createElement("div",{className:"work-edit-info"},H?"Edit":"Original"),u.a.createElement("div",{className:"work-date"},N?B<60?B+" min ago":U<48?U+" hours ago":Object(Xt.a)(N):""))}),nn=Object(f.b)(null,function(e){return{setProjectDragging:function(t){return e(Object(d.ye)(t))},setPersonSelected:function(t){return e(Object(d.kc)(t))}}})(tn),rn=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences,worksLoaded:e.explore.worksLoaded}},null)(function(e){var t=e.allSequences,n=e.onClickWork,r=e.onClickMix,a=e.onClickList,c=e.loadSample,o=e.searchTerm,l=e.searchOptions,d=e.personSelected,f=e.setSearchTag,m=(e.worksLoaded,Object(s.useState)({numTracks:Math.floor(9*window.innerWidth/1e3),scrollTop:0})),p=Object(i.a)(m,2),v=p[0],h=p[1],b=(v.scrollTop,v.numTracks,function(e){var t=e.allSequences,n=e.personSelected,r=e.searchOptions,a=e.searchTerm,c=e.setState,o=Object(s.useState)(!1),u=Object(i.a)(o,2),l=u[0],d=u[1],f=t.filter(function(e){return!n||e.user===n.id}),m=r.indexOf("Samples")>-1,p=r.indexOf("Projects")>-1,v=r.indexOf("Lists")>-1;f=f.filter(function(e){return v&&"LIST"===e.type||m&&("SAMPLES"===e.type||"MIX"===e.type)||p&&"SEQUENCE"===e.type});var h=Object(w.a)(f);return Object(s.useEffect)(function(){console.log("GOING TO BEGINNING"),c({scrollTo:0,numTracks:9}),document.getElementById("works").scrollTo(0,0)},[a,r,c]),Object(s.useEffect)(function(){c({numTracks:9,scrollTop:0})},[n]),{works:h,userWorks:f,isLoading:l,setIsLoading:d}}({allSequences:t,searchTerm:o,searchOptions:l,setState:h})),g=b.userWorks,k=b.works,E=b.setIsLoading,O=b.isLoading,j=function(e){var t=e.setIsLoading,n=e.userWorks,r=e.setState,a=Object(s.useState)((new Date).getMonth()),c=Object(i.a)(a,2),o=c[0],u=c[1],l=Object(s.useState)({}),d=Object(i.a)(l,2),f=d[0],m=d[1];return Object(s.useEffect)(function(){Object(Qt.a)().then(function(e){return m(e)})},[m]),{onClickMonth:Object(s.useCallback)(function(e){t(!0);var a=f[Math.min((new Date).getMonth(),e+1)];if(e==(new Date).getMonth())return r({numTracks:25,scrollTop:0}),u(e),void setTimeout(function(){t(!1)},500);for(var c in n)if(n[c].blockNumber<a){var o=parseInt(c);r({numTracks:o+9,skipTracks:o}),setTimeout(function(){u(e),setTimeout(function(){t(!1)},500)},50);break}},[f,n,r,u,t]),months:f,currentMonth:o,setCurrentMonth:u}}({setIsLoading:E,setState:h,userWorks:g}),S=j.months,y=j.onClickMonth,x=j.setCurrentMonth,C=j.currentMonth,q=function(e){var t=e.setIsLoading,n=e.isLoading,r=e.userWorks,a=e.setCurrentMonth,c=e.months,o=e.state,i=e.setState,u=e.works,l=e.personSelected,d=o.skipTracks,f=o.scrollTop,m=o.numTracks,p=Object(s.useCallback)(function(){if(!(m>=r.length)){var e=document.getElementById("works");if(!n){var o=e.scrollTop+e.offsetHeight,s=e.scrollHeight;if(e.scrollTop<=f-1300&&f>50)setTimeout(function(){i({numTracks:9,scrollTop:0}),e.scrollTo(0,0),a((new Date).getMonth())},200);else if(o>=s){t(!0);var u=m+6;if(!r[u])return void t(!1);var l=r[u].blockNumber;for(var p in c)if(p=parseInt(p),l<c[p]){a(p-1);break}setTimeout(function(){console.log("setting scrollTop=",e.scrollTop),i({skipTracks:d,numTracks:m+6,scrollTop:e.scrollTop}),t(!1)},200)}}}},[m,t,d,n,i,r,a,c,f]);function v(){var e=document.getElementById("works");e&&e.removeEventListener("scroll",p)}Object(s.useEffect)(function(){var e=document.getElementById("works");e&&e.scrollTo(0,0)},[d]),Object(s.useEffect)(function(){var e=document.getElementById("works");i({numTracks:9,scrollTop:0}),e&&e.scrollTo(0,0),a((new Date).getMonth())},[l,a]),Object(s.useEffect)(function(){var e=document.getElementById("works");return e&&e.addEventListener("scroll",p),v},[p,r,o,d]);var h=d;if(void 0===d){var b=Math.max(1,Math.floor((window.innerWidth-110)/420)),g=Math.floor(f/290)*b;9===m&&(g=0),g=Math.max(0,g-50)}var k=u.slice(h,m);return{onScroll:p,scrollWorks:k,toSkip:h=void 0!==d?0:h}}({works:k,setIsLoading:E,isLoading:O,state:v,setState:h,userWorks:g,setCurrentMonth:x,months:S,personSelected:d}),N=(q.onScroll,q.scrollWorks),T=q.toSkip;return u.a.createElement("div",{className:"works-and-months"},u.a.createElement("div",{id:"works"},u.a.createElement("div",{className:"works-grid"},N.map(function(e,t){return u.a.createElement(nn,{setSearchTag:f,loadSample:c,onClick:n,onClickMix:r,onClickList:a,key:t+Math.floor(T)+"-"+e.newSequence+"-"+e.blockNumber,work:e})})),u.a.createElement("div",{className:"loader-container"},u.a.createElement(W.a,{sizeUnit:"px",size:20,color:"#42f4f1",loading:O}))),u.a.createElement(Yt.a,{months:S,onClickMonth:y,currentMonth:C}))});n(1501),t.default=Object(f.b)(function(e,t){var n;return n={allSequences:e.explore.allSequences,personSelected:e.explore.personSelected,worksLoaded:e.explore.worksLoaded,exploreOption:e.explore.exploreOption,annotationsView:e.explore.annotationsView,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,exploreWork:e.explore.exploreWork},Object(r.a)(n,"personSelected",e.explore.personSelected),Object(r.a)(n,"guildId",e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0),n},function(e){return{setAllSequences:function(t){return e(Object(d.hc)(t))},setCommandDown:function(t){return e(Object(d.qb)(t))},setWorksLoaded:function(t){return e(Object(d.Th)(t))},setExploreUnpublished:function(t){return e(Object(d.mc)(t))},setWallpaper:function(t){return e(Object(d.Mh)(t))},setAnimateWallpaper:function(t){return e(Object(d.A)(t))},setExploreWork:function(t){return e(Object(d.nc)(t))}}})(function(e){var t=Object(s.useState)(void 0),n=Object(i.a)(t,2),r=n[0],a=n[1],d=e.personSelected,f=e.worksLoaded,p=(e.setWorksLoaded,e.guildId),v=Object(s.useState)(void 0),b=Object(i.a)(v,2),g=(b[0],b[1]),k=Object(s.useState)([]),E=Object(i.a)(k,2),O=E[0],j=E[1],S=Object(s.useState)(""),y=Object(i.a)(S,2),q=y[0],N=y[1],L=Object(s.useState)(void 0),M=Object(i.a)(L,2),I=M[0],A=M[1],D=Object(s.useState)(["Projects"]),R=Object(i.a)(D,2),P=R[0],W=R[1],H=function(e,t){var n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)([]),u=Object(i.a)(o,2),d=u[0],f=u[1],m=Object(s.useCallback)(function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==t){var r=l.a.getItem("unsavedLists");if(r&&(r=JSON.parse(r)),void 0===t.hash)if(n){var a=e.allSequences.filter(function(e){return e.id!==t.id});e.setAllSequences(a),r&&(r=r.filter(function(e){return e.name!==t.name}),l.a.setItem("unsavedLists",JSON.stringify(r)),e.setExploreUnpublished(r))}else e.setAllSequences([Object(F.a)({},t,{type:"LIST"})].concat(Object(w.a)(e.allSequences)));else if(n){ee(t.newContent);var o=e.allSequences.filter(function(e){return e.hash!==t.hash});e.setAllSequences(o)}c(!1)}else c(!1)},[c,t,e.allSequences]),p=Object(s.useCallback)(function(e){if(d.indexOf(e)>-1){var t=Object(w.a)(d);t.splice(d.indexOf(e),1),f(t)}else f([].concat(Object(w.a)(d),[e]))},[f,d]);return{lists:d,onListChanged:m,onClickList:p,creatingNewList:a,setCreatingNewList:c}}(e,r),G=H.lists,V=H.onListChanged,z=H.onClickList,J=H.creatingNewList,Q=H.setCreatingNewList,Y=Object(s.useState)(!0),_=Object(i.a)(Y,2),$=_[0],K=_[1];Object(s.useEffect)(function(){var t=function(e){C.a.setEthereum(T.a),T.a.store=e,T.a.crypto.store=e,T.a.guilds.initGuilds(),C.a.setStore(e),Te.a.setSampleRate(Le.d);var t=new Ue(e);return window.multiMix=!0,window.sequencerEngine=t,t.ethereum=T.a,t}(e.store);window.explore=!0,a(t),oe(),window.addEventListener("keydown",X),window.addEventListener("keyup",Z)},[]),Object(s.useEffect)(function(){e.setAllSequences([]),K(!0),ct(e.setAllSequences,K,P,q,I,p,d).then(function(e){return K(!1)})},[d,P,K,q,I,p]),Object(s.useEffect)(function(){if(r){var t=e.match&&void 0!=e.match.params.sequenceId?e.match.params.sequenceId:null;t&&T.a.getSequence(t).then(function(n){n||(n={newSequence:t,title:"Unpublished work"}),r.dispatch(Object(Ne.e)(n)),e.setExploreWork(n)})}},[r]);var X=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!0)},[]),Z=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!1)},[]),te=Object(s.useCallback)(function(e){r.dispatch(Object(Ne.h)(e))},[r]),ne=Object(s.useCallback)(function(e){r.dispatch(Object(Ne.e)(e))},[r]),re=Object(s.useCallback)(function(e){r.loadMix(e)},[r]),ae=function(e,t,n){return Object(s.useCallback)(function(){var n=Object(o.a)(c.a.mark(function n(r){var a,o;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.samplerTrack.addSampledInstrumentTrack(),o=new qe.a(r),n.next=4,o.load();case 4:return n.next=6,a.instrument.newSample(0,o);case 6:a.instrument.monophonic=!0,t(Object(w.a)(e.samplerTrack.tracks));case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[t,n,e])}(r,j),ce=function(e,t,n){return Object(s.useCallback)(function(t){n.samplerTrack.deleteTrack(t.trackNumber),e(Object(w.a)(n.samplerTrack.tracks))},[e,t,n])}(j,O,r),oe=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.getUser();case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)(function(){h.isMobile&&f&&f.length>0&&e.setExploreWork(f[0])},[f]);var ie="explore-2",se={};return e.wallpaper?se.backgroundImage="url("+m.a.getHashUrl(e.wallpaper)+")":ie+=" no-wallpaper",e.animateWallpaper&&(ie+=" animate"),Object(s.useEffect)(function(){var t=l.a.getItem("wallpaper");t?e.setWallpaper(t):e.setWallpaper("QmUh2FeN3bw2VdcRVksDctr1ihjDwHpNhE6o9mkBhF2huB"),void 0!==(t=l.a.getItem("animateWallpaper"))&&e.setAnimateWallpaper("true"===t)},[]),f&&f.length>0&&(ie+=" work-loaded"),e.exploreWork&&(ie+=" exploring"),u.a.createElement("div",{className:ie,style:se},u.a.createElement(Ce.a,{condition:e.exploreOption===xe.a},u.a.createElement(ye.a,{store:e.store})),u.a.createElement(Ce.a,{condition:e.exploreOption===xe.b},u.a.createElement(Ee,{annotationsView:e.annotationsView}),u.a.createElement(Jt,{unloadWork:te,sequencerEngine:r,samplersLoaded:O,lists:u.a.createElement(me,{loadWork:ne,removeList:z,onListChanged:V,creatingNewList:J,hide:function(){return Q(!1)},lists:G}),deleteSample:ce,worksLoaded:f},r?u.a.createElement("div",{className:"login-and-comments"},u.a.createElement(Qe,{store:r.store,setSearchOptions:W,searchOptions:P,setSearchTerm:N,searchTerm:q}),u.a.createElement(U,{sequencerEngine:r})):""),u.a.createElement(pe,{onNewList:function(){return Q(!0)}},u.a.createElement(Se,{searchTag:I,setSearchTag:A,setSearchOptions:W,searchOptions:P,setSearchTerm:N,searchTerm:q})),$?u.a.createElement(B.a,{className:"world-fetcher",text:"Fetching the world"}):"",e.exploreWork?u.a.createElement(x,{work:e.exploreWork,sequencerEngine:r}):u.a.createElement(rn,{onClickMix:re,onClickList:z,loadSample:ae,onClickWork:ne,setSearchTag:A,searchOptions:P,searchTerm:q}),u.a.createElement("div",{color:"radial-gradient(75.29% 75.29% at 64.96% 24.36%, #F0DFA7 0.52%, #FDBDAA 18.75%, #FEA186 34.38%, #F09277 49.48%, #D27584 74.48%, #6B7B8A 100%)",className:"coke-machine-glow"})))})}}]);